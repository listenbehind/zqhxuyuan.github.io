<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>HBase BulkLoad | zqhxuyuan</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="HBaseçš„BulkLoadåˆ†æˆäº†ä¸¤ä¸ªè¿‡ç¨‹: MRç”ŸæˆHFile, å¯¼å…¥HFileåˆ°HBaseé›†ç¾¤">
<meta property="og:type" content="article">
<meta property="og:title" content="HBase BulkLoad">
<meta property="og:url" content="http://github.com/zqhxuyuan/2015/12/19/2015-12-19-HBase-BulkLoad/index.html">
<meta property="og:site_name" content="zqhxuyuan">
<meta property="og:description" content="HBaseçš„BulkLoadåˆ†æˆäº†ä¸¤ä¸ªè¿‡ç¨‹: MRç”ŸæˆHFile, å¯¼å…¥HFileåˆ°HBaseé›†ç¾¤">
<meta property="og:image" content="http://img.blog.csdn.net/20151217221820999">
<meta property="og:image" content="http://img.blog.csdn.net/20151217220331750">
<meta property="og:image" content="http://img.blog.csdn.net/20151217221834509">
<meta property="og:image" content="http://img.blog.csdn.net/20151217221852624">
<meta property="og:image" content="http://img.blog.csdn.net/20151218215321046">
<meta property="og:updated_time" content="2016-02-02T03:14:07.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="HBase BulkLoad">
<meta name="twitter:description" content="HBaseçš„BulkLoadåˆ†æˆäº†ä¸¤ä¸ªè¿‡ç¨‹: MRç”ŸæˆHFile, å¯¼å…¥HFileåˆ°HBaseé›†ç¾¤">
  
    <link rel="alternative" href="/atom.xml" title="zqhxuyuan" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="https://avatars1.githubusercontent.com/u/1088525?v=3&amp;s=180" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">ä»»ä½•å¿§ä¼¤,éƒ½æŠµä¸è¿‡ä¸–ç•Œçš„ç¾ä¸½</a></h1>
		</hgroup>

		
				


		
			<div id="switch-btn" class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>èœå•</li>
						<li>æ ‡ç­¾</li>
						
						
						<li>å…³äºæˆ‘</li>
						
					</ul>
				</div>
			</div>
		

		<div id="switch-area" class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">ä¸»é¡µ</a></li>
				        
							<li><a href="/archives/">å½’æ¡£</a></li>
				        
							<li><a href="/tags/">æ ‡ç­¾</a></li>
				        
							<li><a href="/about/">å…³äº</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<ul class="social">
							
								<li id="æ–°æµªå¾®åš"><a class="æ–°æµªå¾®åš" target="_blank" href="http://weibo.com/xuyuantree" title="æ–°æµªå¾®åš"></a></li>
					        
								<li id="GitHub"><a class="GitHub" target="_blank" href="http://github.com/zqhxuyuan" title="GitHub"></a></li>
					        
								<li id="RSS"><a class="RSS" target="_blank" href="/atom.xml" title="RSS"></a></li>
					        
						</ul>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/akka/" style="font-size: 10px;">akka</a> <a href="/tags/apex/" style="font-size: 10px;">apex</a> <a href="/tags/bigdata/" style="font-size: 10px;">bigdata</a> <a href="/tags/book/" style="font-size: 10px;">book</a> <a href="/tags/cassandra/" style="font-size: 18.75px;">cassandra</a> <a href="/tags/clojure/" style="font-size: 10px;">clojure</a> <a href="/tags/drill/" style="font-size: 16.25px;">drill</a> <a href="/tags/druid/" style="font-size: 13.75px;">druid</a> <a href="/tags/dubbo/" style="font-size: 10px;">dubbo</a> <a href="/tags/elasticsearch/" style="font-size: 10px;">elasticsearch</a> <a href="/tags/etl/" style="font-size: 10px;">etl</a> <a href="/tags/geode/" style="font-size: 10px;">geode</a> <a href="/tags/graph/" style="font-size: 13.75px;">graph</a> <a href="/tags/hadoop/" style="font-size: 11.25px;">hadoop</a> <a href="/tags/hbase/" style="font-size: 15px;">hbase</a> <a href="/tags/ignite/" style="font-size: 10px;">ignite</a> <a href="/tags/java/" style="font-size: 10px;">java</a> <a href="/tags/jvm/" style="font-size: 10px;">jvm</a> <a href="/tags/kafka/" style="font-size: 20px;">kafka</a> <a href="/tags/midd/" style="font-size: 10px;">midd</a> <a href="/tags/ops/" style="font-size: 13.75px;">ops</a> <a href="/tags/redis/" style="font-size: 11.25px;">redis</a> <a href="/tags/rocketmq/" style="font-size: 10px;">rocketmq</a> <a href="/tags/scala/" style="font-size: 13.75px;">scala</a> <a href="/tags/spark/" style="font-size: 17.5px;">spark</a> <a href="/tags/storm/" style="font-size: 17.5px;">storm</a> <a href="/tags/timeseries/" style="font-size: 12.5px;">timeseries</a> <a href="/tags/work/" style="font-size: 13.75px;">work</a> <a href="/tags/æµå¤„ç†/" style="font-size: 11.25px;">æµå¤„ç†</a>
					</div>
				</section>
				
				
				

				
				
				<section class="switch-part switch-part3">
				
					<div id="js-aboutme">BIG(DATA)</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide"><a href="/" title="å›åˆ°ä¸»é¡µ">ä»»ä½•å¿§ä¼¤,éƒ½æŠµä¸è¿‡ä¸–ç•Œçš„ç¾ä¸½</a></h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<a href="/" class="profilepic">
				<img lazy-src="https://avatars1.githubusercontent.com/u/1088525?v=3&amp;s=180" class="js-avatar">
			</a>
			<hgroup>
			  <h1 class="header-author"><a href="/" title="å›åˆ°ä¸»é¡µ">ä»»ä½•å¿§ä¼¤,éƒ½æŠµä¸è¿‡ä¸–ç•Œçš„ç¾ä¸½</a></h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">ä¸»é¡µ</a></li>
		        
					<li><a href="/archives/">å½’æ¡£</a></li>
		        
					<li><a href="/tags/">æ ‡ç­¾</a></li>
		        
					<li><a href="/about/">å…³äº</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
						<ul class="social">
							
								<li id="æ–°æµªå¾®åš"><a class="æ–°æµªå¾®åš" target="_blank" href="http://weibo.com/xuyuantree" title="æ–°æµªå¾®åš"></a></li>
					        
								<li id="GitHub"><a class="GitHub" target="_blank" href="http://github.com/zqhxuyuan" title="GitHub"></a></li>
					        
								<li id="RSS"><a class="RSS" target="_blank" href="/atom.xml" title="RSS"></a></li>
					        
						</ul>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap"><article id="post-2015-12-19-HBase-BulkLoad" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/12/19/2015-12-19-HBase-BulkLoad/" class="article-date">
  	<time datetime="2015-12-18T16:00:00.000Z" itemprop="datePublished">2015-12-19</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      HBase BulkLoad
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/bigdata/">bigdata</a>
	</div>


        
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hbase/">hbase</a></li></ul>
	</div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        
        <p>HBaseçš„BulkLoadåˆ†æˆäº†ä¸¤ä¸ªè¿‡ç¨‹: MRç”ŸæˆHFile, å¯¼å…¥HFileåˆ°HBaseé›†ç¾¤<br><a id="more"></a></p>
<h2 id="HBase_BulkLoad">HBase BulkLoad</h2><h3 id="HBase_&amp;_MapReduce">HBase &amp; MapReduce</h3><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[qihuang.zheng<span class="variable">@spark047213</span> ~]<span class="variable">$ </span>hadoop jar hbase-<span class="number">1.0</span>.<span class="number">2</span>/<span class="class"><span class="keyword">lib</span>/<span class="title">hbase</span>-<span class="title">server</span>-1.0.2.<span class="title">jar</span></span></span><br><span class="line"><span class="constant">Exception</span> in thread <span class="string">"main"</span> java.lang.<span class="constant">NoClassDefFoundError</span>: org/apache/hadoop/hbase/filter/<span class="constant">Filter</span></span><br></pre></td></tr></table></figure>
<p>è¿è¡ŒMapReduceä½œä¸šæ—¶,éœ€è¦å°†HBaseçš„ä¾èµ–åŒ…åŠ å…¥åˆ°HADOOP_CLASSPATHä¸­: <a href="http://hbase.apache.org/book.html#hbase.mapreduce.classpath" target="_blank" rel="external">http://hbase.apache.org/book.html#hbase.mapreduce.classpath</a>  </p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">export <span class="constant">HBASE_HOME</span>=<span class="regexp">/home/qihuang</span>.zheng/hbase-<span class="number">1.0</span>.<span class="number">2</span></span><br><span class="line"><span class="constant">HADOOP_CLASSPATH</span>=<span class="string">`$&#123;HBASE_HOME&#125;/bin/hbase classpath`</span> hadoop jar <span class="variable">$&#123;</span><span class="constant">HBASE_HOME</span>&#125;/<span class="class"><span class="keyword">lib</span>/<span class="title">hbase</span>-<span class="title">server</span>-1.0.2.<span class="title">jar</span> <span class="title">rowcounter</span> <span class="title">data</span>.<span class="title">md5_id</span></span></span><br><span class="line"></span><br><span class="line">[qihuang.zheng<span class="variable">@spark047213</span> ~]<span class="variable">$ </span><span class="constant">HADOOP_CLASSPATH</span>=<span class="string">`$&#123;HBASE_HOME&#125;/bin/hbase classpath`</span> hadoop jar <span class="variable">$&#123;</span><span class="constant">HBASE_HOME</span>&#125;/<span class="class"><span class="keyword">lib</span>/<span class="title">hbase</span>-<span class="title">server</span>-1.0.2.<span class="title">jar</span></span></span><br><span class="line"><span class="constant">An</span> example program must be given <span class="keyword">as</span> the first argument.</span><br><span class="line"><span class="constant">Valid</span> program names <span class="symbol">are:</span></span><br><span class="line">  <span class="constant">CellCounter</span>: <span class="constant">Count</span> cells in <span class="constant">HBase</span> table</span><br><span class="line">  <span class="symbol">completebulkload:</span> <span class="constant">Complete</span> a bulk data load.</span><br><span class="line">  <span class="symbol">copytable:</span> <span class="constant">Export</span> a table from local cluster to peer cluster</span><br><span class="line">  <span class="symbol">export:</span> <span class="constant">Write</span> table data to <span class="constant">HDFS</span>.</span><br><span class="line">  <span class="symbol">import:</span> <span class="constant">Import</span> data written by <span class="constant">Export</span>.</span><br><span class="line">  <span class="symbol">importtsv:</span> <span class="constant">Import</span> data in <span class="constant">TSV</span> format.</span><br><span class="line">  <span class="symbol">rowcounter:</span> <span class="constant">Count</span> rows in <span class="constant">HBase</span> table</span><br><span class="line">  <span class="symbol">verifyrep:</span> <span class="constant">Compare</span> the data from tables in two different clusters.</span><br></pre></td></tr></table></figure>
<h3 id="MRä½œä¸šç”ŸæˆHFile">MRä½œä¸šç”ŸæˆHFile</h3><p>You must specify exactly one column to be the row key, and you must specify a column name for every column that exists in the input data.<br><code>importtsv</code>å‘½ä»¤å¯¼å…¥HDFSä¸Šçš„æ–‡ä»¶éœ€è¦æŒ‡å®šå”¯ä¸€çš„row-key,å¹¶ä¸”è¾“å…¥æ•°æ®çš„æ¯ä¸€åˆ—éƒ½éœ€è¦æŒ‡å®šåˆ—å. æ‰€ä»¥åä¸¤åˆ—ä¸æƒ³å­˜å‚¨éƒ½ä¸è¡Œ.  </p>
<blockquote>
<p>In order to function efficiently, HFileOutputFormat2 must be configured such that each output HFile fits within a single region. In order to do this, jobs whose output will be bulk loaded into HBase use Hadoopâ€™s TotalOrderPartitioner class to partition the map output into disjoint ranges of the key space, corresponding to the key ranges of the regions in the table.</p>
</blockquote>
<p>ç¡®ä¿æ¯ä¸ªè¾“å‡ºçš„HFileæ–‡ä»¶éƒ½åªå­˜åœ¨äºå”¯ä¸€çš„Regionä¸­.è¿™æ ·åœ¨å¯¼å…¥åˆ°HBaseé›†ç¾¤ä¸­, åªè¦ç§»åŠ¨HFileæ–‡ä»¶å³å¯.<br>å¦‚æœä¸€ä¸ªHFileæ–‡ä»¶å­˜åœ¨äºä¸æ­¢ä¸€ä¸ªRegionä¸­,åˆ™å¯¼å…¥ä¹‹å,è¿™ä¸ªRegionè¿˜ä¼šè¿›è¡ŒSplit.<br>è€Œæˆ‘ä»¬çš„ç›®çš„æ˜¯ç§»åŠ¨HFileæ–‡ä»¶åç«‹å³å¯ç”¨ä¸”æ²¡æœ‰é¢å¤–çš„å·¥ä½œ. åŒæ—¶å› ä¸ºRegionæ˜¯æ’åºçš„,è¾“å‡ºä¹Ÿå¿…é¡»æ˜¯æœ‰åºçš„.<br>å¯¼å…¥åˆ°HBaseé›†ç¾¤çš„è¾“å‡ºæ–‡ä»¶ä¼šä½¿ç”¨Hadoopçš„TotalOrderPartitionerå°†mapè¾“å‡ºè¿›è¡Œåˆ†åŒº:åˆ†è§£æˆä¸åŒçš„èŒƒå›´<br>è¿™ä¸ªèŒƒå›´ä¹Ÿå¯¹åº”äº†HBaseå»ºè¡¨æ—¶å€™åˆ›å»ºçš„å¤šä¸ªRegionçš„KeyRange.  </p>
<blockquote>
<p>MRè¾“å‡ºçš„æ¯ä¸ªHFileæ–‡ä»¶æ­£å¥½å¯¹åº”äº†HBaseæ¯ä¸ªRegionçš„KeyRange.è¿™æ ·æ–‡ä»¶åªè¦ç›´æ¥æ‹·è´å°±å¯ä»¥ä½¿ç”¨.  </p>
</blockquote>
<p>åœ¨å»ºè¡¨çš„æ—¶å€™é¢„å…ˆåˆ†é…Split: <a href="http://grokbase.com/t/hbase/user/145bkvaq0x/how-to-pre-split-a-table-whose-row-key-is-md5-url" target="_blank" rel="external">http://grokbase.com/t/hbase/user/145bkvaq0x/how-to-pre-split-a-table-whose-row-key-is-md5-url</a>  </p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">create <span class="symbol">'data</span>.md5_mob2', <span class="symbol">'mob'</span>, &#123;<span class="type">NUMREGIONS</span> =&gt; <span class="number">16</span>, <span class="type">SPLITALGO</span> =&gt; <span class="symbol">'HexStringSplit'</span>&#125;</span><br><span class="line">create <span class="symbol">'data</span>.md5_id2', <span class="symbol">'id'</span>, &#123;<span class="type">NUMREGIONS</span> =&gt; <span class="number">16</span>, <span class="type">SPLITALGO</span> =&gt; <span class="symbol">'HexStringSplit'</span>&#125;</span><br><span class="line">create <span class="symbol">'data</span>.md5_id2', <span class="symbol">'id'</span>, &#123;<span class="type">SPLITS_FILE</span> =&gt; <span class="symbol">'split32</span>.txt'&#125;</span><br><span class="line">create <span class="symbol">'data</span>.md5_id4', <span class="symbol">'id'</span>, &#123;<span class="type">SPLITS_FILE</span> =&gt; <span class="symbol">'split32</span>.txt', <span class="type">REGION_REPLICATION</span> =&gt; <span class="number">1</span>, <span class="type">CONFIGURATION</span> =&gt; &#123;<span class="symbol">'hbase</span>.regionserver.region.split.policy' =&gt; <span class="symbol">'KeyPrefixRegionSplitPolicy'</span>, <span class="symbol">'prefix_split_key_policy</span>.prefix_length' =&gt; <span class="char">'3'</span>&#125;&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>å‡è®¾æŒ‰ç…§3ä½(0-f),åˆ™åˆ†åŒºæ•°=16^3=4096,åœ¨å»ºè¡¨æ—¶ä¼šæœ‰é—®é¢˜. äºæ˜¯æ”¹æˆäº†16<em>16</em>8=2048ä¸ªRegion(å®é™…ä¸Šä¼šå¤šä¸€ä¸ªRegionçš„).  </p>
</blockquote>
<p><code>sh hfile.sh id_mdf_tmp1 id_hbase1</code></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="shebang">#!/bin/sh</span></span><br><span class="line"><span class="comment">#Usage: importtsv -Dimporttsv.columns=a,b,c &lt;tablename&gt; &lt;inputdir&gt;</span></span><br><span class="line">input=<span class="variable">$1</span></span><br><span class="line">output=<span class="variable">$2</span></span><br><span class="line">HADOOP_CLASSPATH=`hbase classpath` hadoop jar <span class="variable">$&#123;HBASE_HOME&#125;</span>/lib/hbase-server-<span class="number">1.0</span>.<span class="number">2</span>.jar importtsv \</span><br><span class="line">-Dimporttsv.columns=id:id,HBASE_ROW_KEY,id:c1,id:c2 \</span><br><span class="line">-Dimporttsv.separator=, \</span><br><span class="line">-Dimporttsv.bulk.output=/user/tongdun/<span class="variable">$output</span> \</span><br><span class="line">-Dcreate.table=no \</span><br><span class="line">-Dno.strict=<span class="literal">true</span> \</span><br><span class="line">-Dmapreduce.map.speculative=<span class="literal">false</span> \</span><br><span class="line">-Dmapreduce.reduce.speculative=<span class="literal">false</span> \</span><br><span class="line">data.md5_id2 /user/tongdun/<span class="variable">$input</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>å¦‚æœåªæ˜¯KeyValueæ•°æ®,å¯ä»¥ä¸è®¾ç½®Column.åªæœ‰ColumnFamily. ä½†æ˜¯ç”±äºæºæ•°æ®åŒ…æ‹¬äº†å››ä¸ªå­—æ®µ,åœ¨è¡¨ä¸­éƒ½å¿…é¡»å¯¹åº”å­—æ®µ.<br>å¦‚æœæ²¡æœ‰æŒ‡å®šimporttsv.bulk.output,åˆ™ç›´æ¥å†™å…¥åˆ°HBaseé›†ç¾¤.æŒ‡å®šçš„è¯å…ˆåœ¨HDFSä¸Šç”ŸæˆHFileæ–‡ä»¶.è¿™æ—¶å¹¶ä¸ä¼šå†™æ•°æ®åˆ°HBaseä¸­.  </p>
</blockquote>
<h3 id="MRä»»åŠ¡å†…å­˜ä¸è¶³">MRä»»åŠ¡å†…å­˜ä¸è¶³</h3><p>ç”±äºè¿è¡ŒMapReduceçš„èµ„æºæœ‰é™,å¦‚æœè¯»å–å¤ªå¤§çš„æ–‡ä»¶,ä¼šé€ æˆå†…å­˜ä¸è¶³.ä½†æ˜¯ä»…ä»…æ˜¯ä¸€ä¸ª26Gæ–‡ä»¶,ä¹Ÿä¼šæœ‰Containerå†…å­˜ä¸è¶³.æ›´ä½•å†µè¿˜æœ‰100å¤šGçš„æ–‡ä»¶å‘¢!   </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Container [pid=48778,containerID=container_1449135806348_0034_01_000162] is running beyond physical memory limits. Current usage: 4.0 GB of 4 GB physical memory used; 4.7 GB of 8.4 GB virtual memory used. Killing container.</span><br><span class="line">Dump of the process-tree for container_1449135806348_0034_01_000162 :</span><br><span class="line">        |- PID PPID PGRPID SESSID CMD_NAME USER_MODE_TIME(MILLIS) SYSTEM_TIME(MILLIS) VMEM_USAGE(BYTES) RSSMEM_USAGE(PAGES) FULL_CMD_LINE</span><br><span class="line">        |- 48795 48778 48778 48778 (java) 3961 5369 5007175680 1054447 /usr/<span class="operator"><span class="keyword">install</span>/<span class="keyword">java</span>/<span class="keyword">bin</span>/<span class="keyword">java</span> -Djava.net.preferIPv4Stack=<span class="literal">true</span> -Dhadoop.metrics.<span class="keyword">log</span>.<span class="keyword">level</span>=WARN -Xmx4096m -Djava.io.tmpdir=/home/<span class="keyword">admin</span>/hadoop/<span class="keyword">data</span>/yarn-tmp/nmdir/usercache/qihuang.zheng/appcache/application_1449135806348_0034/container_1449135806348_0034_01_000162/tmp -Dlog4j.configuration=<span class="keyword">container</span>-log4j.properties -Dyarn.app.<span class="keyword">container</span>.<span class="keyword">log</span>.dir=/home/<span class="keyword">admin</span>/<span class="keyword">output</span>/hadoop/<span class="keyword">logs</span>/application_1449135806348_0034/container_1449135806348_0034_01_000162 -Dyarn.app.<span class="keyword">container</span>.<span class="keyword">log</span>.filesize=<span class="number">0</span> -Dhadoop.root.logger=INFO,CLA org.apache.hadoop.mapred.YarnChild <span class="number">192.168</span><span class="number">.47</span><span class="number">.242</span> <span class="number">40792</span> attempt_1449135806348_0034_r_000015_0 <span class="number">162</span></span><br><span class="line">        |- <span class="number">48778</span> <span class="number">11861</span> <span class="number">48778</span> <span class="number">48778</span> (bash) <span class="number">0</span> <span class="number">1</span> <span class="number">9424896</span> <span class="number">308</span> /<span class="keyword">bin</span>/bash -<span class="keyword">c</span> /usr/<span class="keyword">install</span>/<span class="keyword">java</span>/<span class="keyword">bin</span>/<span class="keyword">java</span> -Djava.net.preferIPv4Stack=<span class="literal">true</span> -Dhadoop.metrics.<span class="keyword">log</span>.<span class="keyword">level</span>=WARN  -Xmx4096m -Djava.io.tmpdir=/home/<span class="keyword">admin</span>/hadoop/<span class="keyword">data</span>/yarn-tmp/nmdir/usercache/qihuang.zheng/appcache/application_1449135806348_0034/container_1449135806348_0034_01_000162/tmp -Dlog4j.configuration=<span class="keyword">container</span>-log4j.properties -Dyarn.app.<span class="keyword">container</span>.<span class="keyword">log</span>.dir=/home/<span class="keyword">admin</span>/<span class="keyword">output</span>/hadoop/<span class="keyword">logs</span>/application_1449135806348_0034/container_1449135806348_0034_01_000162 -Dyarn.app.<span class="keyword">container</span>.<span class="keyword">log</span>.filesize=<span class="number">0</span> -Dhadoop.root.logger=INFO,CLA org.apache.hadoop.mapred.YarnChild <span class="number">192.168</span><span class="number">.47</span><span class="number">.242</span> <span class="number">40792</span> attempt_1449135806348_0034_r_000015_0 <span class="number">162</span> <span class="number">1</span>&gt;/home/<span class="keyword">admin</span>/<span class="keyword">output</span>/hadoop/<span class="keyword">logs</span>/application_1449135806348_0034/container_1449135806348_0034_01_000162/stdout <span class="number">2</span>&gt;/home/<span class="keyword">admin</span>/<span class="keyword">output</span>/hadoop/<span class="keyword">logs</span>/application_1449135806348_0034/container_1449135806348_0034_01_000162/stderr</span><br><span class="line"></span><br><span class="line"><span class="keyword">Container</span> killed <span class="keyword">on</span> request. <span class="keyword">Exit</span> code <span class="keyword">is</span> <span class="number">143</span></span><br><span class="line"><span class="keyword">Container</span> exited <span class="keyword">with</span> a non-zero <span class="keyword">exit</span> code <span class="number">143</span></span></span><br></pre></td></tr></table></figure>
<p>å‚è€ƒ: <a href="http://stackoverflow.com/questions/21005643/container-is-running-beyond-memory-limits" target="_blank" rel="external">http://stackoverflow.com/questions/21005643/container-is-running-beyond-memory-limits</a></p>
<p>YARNçš„ApplicationMasterä¹Ÿå ç”¨äº†NMä¸­çš„ä¸€ä¸ªContainer. åœ¨åˆšåˆšå¯åŠ¨AMæ—¶,è¿˜æ²¡æœ‰å¯åŠ¨MRä»»åŠ¡æ—¶:  </p>
<p><img src="http://img.blog.csdn.net/20151217221820999" alt="mr_am"></p>
<p>æ·»åŠ å‚æ•°,ä¿®æ”¹map/reduceçš„å†…å­˜ä¸º5G.    </p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-Dmapreduce<span class="class">.map</span><span class="class">.memory</span><span class="class">.mb</span>=<span class="number">5120</span> -Dmapreduce<span class="class">.map</span><span class="class">.java</span><span class="class">.opts</span>=-Xmx4096m \</span><br><span class="line">-Dmapreduce<span class="class">.reduce</span><span class="class">.memory</span><span class="class">.mb</span>=<span class="number">5120</span> -Dmapreduce<span class="class">.reduce</span><span class="class">.java</span><span class="class">.opts</span>=-Xmx4096m \</span><br></pre></td></tr></table></figure>
<p><img src="http://img.blog.csdn.net/20151217220331750" alt="mr-5g"></p>
<h3 id="MRä»»åŠ¡å†…å­˜è°ƒä¼˜">MRä»»åŠ¡å†…å­˜è°ƒä¼˜</h3><p>ç”±äºå¯ç”¨å†…å­˜æ¯ä¸ªèŠ‚ç‚¹åªæœ‰24G. ä¸€å…±9ä¸ªNM. 24Gçš„å†…å­˜åˆ†æˆ5G,ä¸€ä¸ªèŠ‚ç‚¹æœ€å¤šå¯åŠ¨4ä¸ªContainer,æœ€åå‰©ä½™4G. è¿™4ä¸ªGå¯ä»¥åˆ†ç»™Reduce </p>
<p>26Gæ–‡ä»¶, 209ä¸ªMapTasks, 16ä¸ªReduces. MapNumer=26*1024/128(BlockSize)=209.<br>Reduceçš„æ•°é‡æ˜¯æ ¹æ®HBaseä¸­çš„Regionæ•°é‡æ˜¯å›ºå®šçš„:å› ä¸ºä½¿ç”¨äº†<code>NUMREGIONS =&gt; 16, SPLITALGO =&gt; &#39;HexStringSplit&#39;</code>  </p>
<p>è¿™æ ·9ä¸ªèŠ‚ç‚¹,16ä¸ªReduceTask,æ¯ä¸ªèŠ‚ç‚¹è¿è¡Œäº†2ä¸ªReduce,å‰©ä½™çš„4Gå¯ä»¥ç»™æ¯ä¸ªReduceå¢åŠ 2G. </p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-Dmapreduce<span class="class">.map</span><span class="class">.memory</span><span class="class">.mb</span>=<span class="number">5120</span> -Dmapreduce<span class="class">.map</span><span class="class">.java</span><span class="class">.opts</span>=-Xmx4096m \</span><br><span class="line">-Dmapreduce<span class="class">.reduce</span><span class="class">.memory</span><span class="class">.mb</span>=<span class="number">7189</span> -Dmapreduce<span class="class">.reduce</span><span class="class">.java</span><span class="class">.opts</span>=-Xmx6144m \</span><br></pre></td></tr></table></figure>
<p>127G,MapTasks=127*8=1016.  </p>
<p><img src="http://img.blog.csdn.net/20151217221834509" alt="mr_127g"></p>
<p>åœ¨è¿˜æ²¡æœ‰è¿è¡ŒReduceä»»åŠ¡æ—¶,ç”±äºæ¯ä¸ªMapçš„å†…å­˜æœ€å¤š5G,æ‰€ä»¥æ¯ä¸ªèŠ‚ç‚¹å‰©ä½™çš„å†…å­˜ä¹Ÿéƒ½æ˜¯4G.<br>ä¸€æ—¦Reduceä»»åŠ¡è¿è¡Œèµ·æ¥,ä¸€ä¸ªReduceä»»åŠ¡7G. åŸå…ˆä¸€ä¸ªèŠ‚ç‚¹4ä¸ªMap,å½“ä¸€ä¸ªMapå®Œæˆå,é‡Šæ”¾5Gç©ºé—´,å‰©ä½™9G.<br>æ­¤æ—¶å¯åŠ¨äº†ä¸€ä¸ªReduce,åˆ™å‰©ä½™ç©ºé—´æ˜¯9-7=2G. ä½†æ˜¯ä¸‹å›¾çœ‹åˆ°å‰©ä½™çš„å´æ˜¯1G. <code>ä»€ä¹ˆä¸œè¥¿å¤šå ç”¨äº†1G?</code>  </p>
<p><img src="http://img.blog.csdn.net/20151217221852624" alt="mr_reduce"></p>
<p>Mapä»»åŠ¡æ˜¯å¯¹è¾“å…¥æ–‡ä»¶æŒ‰ç…§128Mè¿›è¡Œåˆ’åˆ†.è€ŒReduceå›ºå®š16ä¸ª.åœ¨å¤§æ–‡ä»¶çš„æƒ…å†µä¸‹,æ¯ä¸ªReduceçš„æ•°æ®é‡ä¹Ÿå¾ˆå¤§.å†…å­˜èƒ½å¤Ÿæ’‘å¾—ä½?  </p>
<h3 id="ç”ŸæˆHFileæ–‡ä»¶">ç”ŸæˆHFileæ–‡ä»¶</h3><p>åŸå§‹æ–‡ä»¶27G. Reduceæ•°é‡16ä¸ª,ç”Ÿæˆçš„16ä¸ªæ–‡ä»¶éƒ½æœ‰5.5G.å¯ä»¥çœ‹åˆ°æ–‡ä»¶åå®é™…ä¸Šå·²ç»èƒ½ç¡®å®šRegionäº†.<br>26Gæ–‡ä»¶ç”ŸæˆHFileèŠ±äº†20min. 6Téœ€è¦<code>6*1024*20/26/60=3Day</code>. çœ‹èµ·æ¥æ¯”è„šæœ¬å¤„ç†å¿«å¤šäº†.   </p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[qihuang.zheng<span class="annotation">@spark</span>047213 ~]$ hadoop fs -du -h <span class="regexp">/user/</span>tongdun<span class="regexp">/id_hbase1_1/</span>id</span><br><span class="line"><span class="number">5.5</span> G  <span class="regexp">/user/</span>tongdun<span class="regexp">/id_hbase1_1/</span>id/<span class="number">00</span>acc7bdb9444ede81bd938c772e420f</span><br><span class="line"><span class="number">5.5</span> G  <span class="regexp">/user/</span>tongdun<span class="regexp">/id_hbase1_1/</span>id/<span class="number">0671</span>fcdbd0884eecaed2876060a203fe</span><br><span class="line"><span class="number">5.5</span> G  <span class="regexp">/user/</span>tongdun<span class="regexp">/id_hbase1_1/</span>id/<span class="number">069</span>cafcd20d947ec80fc2063415886ca</span><br><span class="line"><span class="number">5.5</span> G  <span class="regexp">/user/</span>tongdun<span class="regexp">/id_hbase1_1/</span>id/<span class="number">12144090330941</span>c3a6236fa899c3b8f5</span><br><span class="line"><span class="number">5.5</span> G  <span class="regexp">/user/</span>tongdun<span class="regexp">/id_hbase1_1/</span>id/<span class="number">3870800164104</span>b92a64db7f80757d750</span><br><span class="line"><span class="number">5.5</span> G  <span class="regexp">/user/</span>tongdun<span class="regexp">/id_hbase1_1/</span>id/<span class="number">41</span>d52b83667a49f8ba4ea68336c2c66c</span><br><span class="line"><span class="number">5.5</span> G  <span class="regexp">/user/</span>tongdun<span class="regexp">/id_hbase1_1/</span>id/<span class="number">4</span>de99c7e03804ed085bf63c1c828d700</span><br><span class="line"><span class="number">5.5</span> G  <span class="regexp">/user/</span>tongdun<span class="regexp">/id_hbase1_1/</span>id/<span class="number">541</span>c7dfa1fa74b139d93a5ef10049934</span><br><span class="line"><span class="number">5.5</span> G  <span class="regexp">/user/</span>tongdun<span class="regexp">/id_hbase1_1/</span>id/<span class="number">5</span>a6819f2d0864cde8450c1d5676bab07</span><br><span class="line"><span class="number">5.5</span> G  <span class="regexp">/user/</span>tongdun<span class="regexp">/id_hbase1_1/</span>id/<span class="number">5</span>f8fe4436d6443e18c2e120d2f5d07f0</span><br><span class="line"><span class="number">5.5</span> G  <span class="regexp">/user/</span>tongdun<span class="regexp">/id_hbase1_1/</span>id/<span class="number">77</span>f018a00d3543abb54de65bba26419d</span><br><span class="line"><span class="number">5.5</span> G  <span class="regexp">/user/</span>tongdun<span class="regexp">/id_hbase1_1/</span>id/b35a2c68790c4b31bf0b59511b4baf7b</span><br><span class="line"><span class="number">5.5</span> G  <span class="regexp">/user/</span>tongdun<span class="regexp">/id_hbase1_1/</span>id/bab7d211bf614bc48d9661df9ba68d81</span><br><span class="line"><span class="number">5.5</span> G  <span class="regexp">/user/</span>tongdun<span class="regexp">/id_hbase1_1/</span>id/bd1cc8041aaf47ec980d7855d42f34c6</span><br><span class="line"><span class="number">5.5</span> G  <span class="regexp">/user/</span>tongdun<span class="regexp">/id_hbase1_1/</span>id/cbd41ef63b984d45ba49be5c3f0e5466</span><br><span class="line"><span class="number">5.5</span> G  <span class="regexp">/user/</span>tongdun<span class="regexp">/id_hbase1_1/</span>id/f01fbad0952b496bab2e4ab199c196cd</span><br></pre></td></tr></table></figure>
<blockquote>
<p>é—®é¢˜: ä¸ºä»€ä¹ˆä¸æ˜¯0-få¼€å¤´çš„æ¯ä¸ªéƒ½æœ‰ä¸€ä¸ªæ–‡ä»¶.ä¸Šé¢0å¼€å¤´çš„æœ‰ä¸‰ä¸ªæ–‡ä»¶.2å¼€å¤´çš„éƒ½æ²¡æœ‰.èƒ½å¯¹åº”ä¸ŠKeyRangeå—?  </p>
</blockquote>
<h3 id="å¯¼å…¥HBaseé›†ç¾¤å’ŒéªŒè¯æ•°æ®">å¯¼å…¥HBaseé›†ç¾¤å’ŒéªŒè¯æ•°æ®</h3><blockquote>
<p>completebulkload tool is used to import the data into the running cluster: iterates through the prepared data files, and for each one determines the region the file belongs to. It then contacts the appropriate RegionServer which adopts the HFile, moving it into its storage directory and making the data available to clients.<br>å¾ªç¯æ¯ä¸ªHFileæ–‡ä»¶,å†³å®šè¿™ä¸ªæ–‡ä»¶å±äºå“ªä¸ªRegion,è”ç³»å¯¹åº”çš„RegionServer,ç§»åŠ¨åˆ°RSçš„å­˜å‚¨ç›®å½•,å®¢æˆ·ç«¯æŸ¥è¯¢æ•°æ®.  </p>
</blockquote>
<p>A.å°†ç”Ÿæˆçš„HFileå¯¼å…¥åˆ°HBaseé›†ç¾¤ä¸­å¯ä»¥ç”¨hbaseçš„å¢é‡åŠ è½½: <code>hbase org.apache.hadoop.hbase.mapreduce.LoadIncrementalHFiles $output data.md5_id2</code><br>B.ä»ç„¶ä½¿ç”¨hadoopå‘½ä»¤,ä½†å’Œå‰é¢åˆ›å»ºHFileä¸åŒ,è¿™æ˜¯ä¸€ä¸ªhdfsçš„mvæ“ä½œ,å¹¶ä¸ä¼šå¯åŠ¨MapReduce: <code>HADOOP_CLASSPATH=</code>hbase classpath<code>hadoop jar ${HBASE_HOME}/lib/hbase-server-1.0.2.jar completebulkload $output data.md5_id2</code></p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="constant">HADOOP_CLASSPATH</span>=<span class="string">`hbase classpath`</span> hadoop jar <span class="variable">$&#123;</span><span class="constant">HBASE_HOME</span>&#125;/lib/hbase-server-<span class="number">1.0</span>.<span class="number">2</span>.jar completebulkload /user/tongdun/id_hbase/id_hbase1_1 data.md5_id2</span><br><span class="line"></span><br><span class="line"><span class="prompt">hbase(main):001:0&gt;</span> list</span><br><span class="line"><span class="constant">TABLE</span></span><br><span class="line">data.md5_id</span><br><span class="line">data.md5_id2</span><br><span class="line"><span class="number">2</span> row(s) <span class="keyword">in</span> <span class="number">0</span>.<span class="number">9380</span> seconds</span><br><span class="line"><span class="status"></span><br><span class="line">=&gt;</span> [<span class="string">"data.md5_id"</span>, <span class="string">"data.md5_id2"</span>]</span><br><span class="line"><span class="prompt">hbase(main):002:0&gt;</span> get <span class="string">"data.md5_id2"</span>,<span class="string">"000045d573fb248697bb9c3f8536c1b5"</span></span><br><span class="line"><span class="constant">COLUMN</span>                                             <span class="constant">CELL</span></span><br><span class="line"> <span class="symbol">id:</span>c1                                             timestamp=<span class="number">1450359965709</span>, value=<span class="number">00</span></span><br><span class="line"> <span class="symbol">id:</span>c2                                             timestamp=<span class="number">1450359965709</span>, value=<span class="number">00</span></span><br><span class="line"> <span class="symbol">id:</span>id                                             timestamp=<span class="number">1450359965709</span>, value=<span class="number">110100195503206224</span></span><br><span class="line"><span class="number">3</span> row(s) <span class="keyword">in</span> <span class="number">1.0650</span> seconds</span><br><span class="line"></span><br><span class="line"><span class="prompt">hbase(main):004:0&gt;</span> get <span class="string">"data.md5_id2"</span>,<span class="string">"ddd5df06f27f9e127eb5816b338970dd"</span></span><br><span class="line"><span class="constant">COLUMN</span>                                             <span class="constant">CELL</span></span><br><span class="line"> <span class="symbol">id:</span>id                                             timestamp=<span class="number">1450359965709</span>, value=<span class="number">110100195512089920</span></span><br><span class="line"><span class="number">3</span> row(s) <span class="keyword">in</span> <span class="number">0</span>.<span class="number">1520</span> seconds</span><br></pre></td></tr></table></figure>
<p>ç”±äºæ˜¯ç§»åŠ¨æ–‡ä»¶, /user/tongdun/id_hbase/id_hbase1_1ä¼šè¢«ç§»åŠ¨åˆ°HDFSä¸­hbaseçš„å­˜å‚¨è·¯å¾„: ä½†æ˜¯è²Œä¼¼åå­—ä¸æ˜¯ä¸€æ ·çš„ </p>
<p><img src="http://img.blog.csdn.net/20151218215321046" alt="hbase-path"></p>
<p>ç”±äºcompletebulkloadçš„æ–‡ä»¶å¤¹ä¸‹çº§å¿…é¡»æ˜¯column-family:id,æ‰¹é‡å¯¼å…¥è„šæœ¬:  </p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="shebang">#!/bin/sh</span></span><br><span class="line"><span class="keyword">for</span> f <span class="keyword">in</span> `hadoop fs -ls /user/tongdun/id_hbase | awk <span class="string">'&#123;print $8&#125;'</span>`</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  HADOOP_CLASSPATH=`hbase classpath` hadoop jar <span class="variable">$&#123;HBASE_HOME&#125;</span>/lib/hbase-server-<span class="number">1.0</span>.<span class="number">2</span>.jar completebulkload <span class="variable">$f</span> data.md5_id2</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<h3 id="å¢åŠ (æ‰‹æœºå·)æ–°æ•°æ®æµç¨‹">å¢åŠ (æ‰‹æœºå·)æ–°æ•°æ®æµç¨‹</h3><p>1.ä¸Šä¼ æ–‡ä»¶åˆ°HDFS: <code>hadoop fs -put mobile_173.txt /user/tongdun/mob_173</code><br>2.ç”ŸæˆHFileå¹¶å¯¼å…¥åˆ°HBase: <code>sh hfile2.sh mob_173 mob_173_out</code>  </p>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">input=<span class="variable">$1</span></span><br><span class="line">output=<span class="variable">$2</span></span><br><span class="line"></span><br><span class="line">HADOOP_CLASSPATH=`$&#123;HBASE_HOME&#125;/bin/hbase classpath` hadoop jar $&#123;HBASE_HOME&#125;/lib/hbase-server-<span class="number">1.0</span>.<span class="number">2</span>.jar importtsv \</span><br><span class="line">-Dimporttsv.columns=mob:mob,HBASE_ROW_KEY \</span><br><span class="line">-Dimporttsv.separator=, \</span><br><span class="line">-Dimporttsv.bulk.output=/user/tongdun/<span class="variable">$output</span> \</span><br><span class="line">-Dcreate.table=no \</span><br><span class="line">-Dno.strict=<span class="literal">true</span> \</span><br><span class="line">-Dmapreduce.<span class="keyword">map</span>.speculative=<span class="literal">false</span> \</span><br><span class="line">-Dmapreduce.reduce.speculative=<span class="literal">false</span> \</span><br><span class="line">-Dmapreduce.<span class="keyword">map</span>.memory.mb=<span class="number">5120</span> -Dmapreduce.<span class="keyword">map</span>.java.opts=-Xmx4096m \</span><br><span class="line">-Dmapreduce.reduce.memory.mb=<span class="number">7189</span> -Dmapreduce.reduce.java.opts=-Xmx6144m \</span><br><span class="line">data.md5_mob2 /user/tongdun/<span class="variable">$input</span></span><br><span class="line"></span><br><span class="line">HADOOP_CLASSPATH=`hbase classpath` hadoop jar $&#123;HBASE_HOME&#125;/lib/hbase-server-<span class="number">1.0</span>.<span class="number">2</span>.jar completebulkload /user/tongdun/<span class="variable">$output</span> data.md5_mob2</span><br></pre></td></tr></table></figure>
<blockquote>
<p>æ³¨æ„: è¦æ ¹æ®æºæ–‡ä»¶æ ¼å¼,æ¯”å¦‚mobile_173.txtåªæœ‰ä¸¤åˆ—,åˆ†åˆ«æ˜¯æ‰‹æœºå·å’Œmd5.<br>å¯¹äºæ‰‹æœºå·,åˆ›å»ºè¡¨æ—¶æŒ‡å®šçš„åˆ—æ—ä¸ºmob,åˆ—åä¹Ÿæ˜¯mob.  </p>
<p>ä¸Šé¢ç¬¬ä¸€ä¸ªå‘½ä»¤ä¼šåœ¨outputç”Ÿæˆæ–‡ä»¶, ä½†æ˜¯ç¬¬äºŒä¸ªå‘½ä»¤ä¼šç§»åŠ¨åˆ°hbaseä¸­,æ‰€ä»¥æœ€ç»ˆoutputæ˜¯æ²¡æœ‰æ–‡ä»¶çš„.</p>
</blockquote>
<p>æˆ–è€…ç›´æ¥å°†æ–‡æœ¬æ–‡ä»¶å¯¼å…¥åˆ°HBaseä¸­: <code>nohup sh hfile3.sh &amp;</code></p>
<figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">HADOOP_CLASSPATH=`$&#123;HBASE_HOME&#125;/bin/hbase classpath` hadoop jar $&#123;HBASE_HOME&#125;/lib/hbase-server-1.0.2.jar importtsv \</span><br><span class="line">-<span class="ruby"><span class="constant">Dimporttsv</span>.columns=<span class="symbol">mob:</span>mob,<span class="constant">HBASE_ROW_KEY</span> \</span><br><span class="line"></span>-<span class="ruby"><span class="constant">Dimporttsv</span>.separator=, \</span><br><span class="line"></span>-<span class="ruby"><span class="constant">Dcreate</span>.table=no \</span><br><span class="line"></span>-<span class="ruby"><span class="constant">Dno</span>.strict=<span class="keyword">true</span> \</span><br><span class="line"></span>-<span class="ruby"><span class="constant">Dmapreduce</span>.map.speculative=<span class="keyword">false</span> \</span><br><span class="line"></span>-<span class="ruby"><span class="constant">Dmapreduce</span>.reduce.speculative=<span class="keyword">false</span> \</span><br><span class="line"></span>-<span class="ruby"><span class="constant">Dmapreduce</span>.map.memory.mb=<span class="number">5120</span> -<span class="constant">Dmapreduce</span>.map.java.opts=-<span class="constant">Xmx4096m</span> \</span><br><span class="line"></span>-<span class="ruby"><span class="constant">Dmapreduce</span>.reduce.memory.mb=<span class="number">7189</span> -<span class="constant">Dmapreduce</span>.reduce.java.opts=-<span class="constant">Xmx6144m</span> \</span><br><span class="line"></span>data.md5_mob2 /user/tongdun/mob_173/mobbile_173.txt</span><br></pre></td></tr></table></figure>
<p>æŸ¥çœ‹MRä½œä¸š: <code>yarn application -list</code></p>
<h4 id="éªŒè¯æ–°å¢æ•°æ®">éªŒè¯æ–°å¢æ•°æ®</h4><p>hdfs:  </p>
<figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[qihuang.zheng@spark047213 ~]$ hadoop fs -cat /user/tongdun/mob_173/*.txt | head</span><br><span class="line"><span class="number">17300000000</span>,04b8c36de88db9ad1aa488b3beb960ea</span><br><span class="line"><span class="number">17300000001</span>,<span class="number">0d0a267</span>f<span class="number">88504864508</span>3110b9dcfc770</span><br><span class="line"><span class="number">17300000002</span>,<span class="number">5a0c8c8</span>e<span class="number">5682476d2</span>e<span class="number">5a6446995</span>f116a</span><br></pre></td></tr></table></figure>
<p>hbase:  </p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">hbase</span><span class="params">(main)</span></span>:<span class="number">006</span>:<span class="number">0</span>&gt; get <span class="string">'data.md5_mob2'</span>,<span class="string">'04b8c36de88db9ad1aa488b3beb960ea'</span></span><br><span class="line">COLUMN                                             CELL</span><br><span class="line"> mob:mob                                           timestamp=<span class="number">1454381066042</span>, value=<span class="number">17300000000</span></span><br><span class="line"><span class="number">1</span> <span class="function"><span class="title">row</span><span class="params">(s)</span></span> <span class="keyword">in</span> <span class="number">0.0280</span> seconds</span><br></pre></td></tr></table></figure>
<h3 id="ä¿®æ”¹å‰¯æœ¬æ•°">ä¿®æ”¹å‰¯æœ¬æ•°</h3><table>
<thead>
<tr>
<th>Input</th>
<th>Output</th>
<th>Time</th>
<th>multi</th>
</tr>
</thead>
<tbody>
<tr>
<td>26G</td>
<td>87.3G</td>
<td>20min</td>
<td>3.3</td>
</tr>
<tr>
<td>806.5G</td>
<td>2.6T</td>
<td>10h</td>
<td>3.3</td>
</tr>
<tr>
<td>6T</td>
<td>18T</td>
<td>â€¦</td>
<td>3</td>
</tr>
</tbody>
</table>
<p>æ•°æ®é‡æœ‰ç‚¹å¤§,æ‰€ä»¥è€ƒè™‘æŠŠè¿™äº›æ•°æ®çš„å‰¯æœ¬æ•°éƒ½è®¾ç½®ä¸º1,å‡å°‘æ•°æ®çš„å ç”¨ç©ºé—´.    </p>
<p>To set replication of an individual file to 4:  <code>hadoop fs -setrep -w 4 /path/to/file</code><br>You can also do this recursively. To change replication of entire HDFS to 1: <code>hadoop fs -setrep -R -w 1 /</code></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">nohup hadoop fs -setrep -R -w <span class="number">1</span> /hbase/data/<span class="keyword">default</span> &amp;</span><br><span class="line">nohup hadoop fs -setrep -R -w <span class="number">1</span> /user/tongdun/id_mdf* &amp;</span><br><span class="line">nohup hadoop fs -setrep -R -w <span class="number">1</span> /user/tongdun/id_hbase* &amp;</span><br><span class="line">nohup hadoop fs -setrep -R -w <span class="number">1</span> /user/tongdun/mob_mdf_tmp* &amp; </span><br><span class="line">nohup hadoop fs -setrep -R -w <span class="number">1</span> /user/tongdun/mob_hbase &amp;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>-Ré€‰é¡¹è¡¨ç¤ºé€’å½’,æ‰€ä»¥æœ€åé¢çš„å‚æ•°å¯ä»¥æ˜¯æ–‡ä»¶å¤¹.  </p>
</blockquote>
<h3 id="Ref">Ref</h3><ul>
<li><a href="https://phoenix.apache.org/bulk_dataload.html" target="_blank" rel="external">https://phoenix.apache.org/bulk_dataload.html</a>  </li>
<li><a href="http://blog.cloudera.com/blog/2013/09/how-to-use-hbase-bulk-loading-and-why/" target="_blank" rel="external">http://blog.cloudera.com/blog/2013/09/how-to-use-hbase-bulk-loading-and-why/</a>   </li>
<li><a href="http://hbase.apache.org/book.html#importtsv" target="_blank" rel="external">http://hbase.apache.org/book.html#importtsv</a> </li>
<li><a href="http://hbase.apache.org/book.html#arch.bulk.load.arch" target="_blank" rel="external">http://hbase.apache.org/book.html#arch.bulk.load.arch</a></li>
<li><a href="http://blog.csdn.net/samhacker/article/details/21282243" target="_blank" rel="external">http://blog.csdn.net/samhacker/article/details/21282243</a>  </li>
<li><a href="http://my.oschina.net/leejun2005/blog/187309" target="_blank" rel="external">http://my.oschina.net/leejun2005/blog/187309</a></li>
</ul>

      
    </div>
    
  </div>
  
    
<div class="copyright">
  <p><span>æœ¬æ–‡æ ‡é¢˜:</span><a href="/2015/12/19/2015-12-19-HBase-BulkLoad/">HBase BulkLoad</a></p>
  <p><span>æ–‡ç« ä½œè€…:</span><a href="/" title="è®¿é—® ä»»ä½•å¿§ä¼¤,éƒ½æŠµä¸è¿‡ä¸–ç•Œçš„ç¾ä¸½ çš„ä¸ªäººåšå®¢">ä»»ä½•å¿§ä¼¤,éƒ½æŠµä¸è¿‡ä¸–ç•Œçš„ç¾ä¸½</a></p>
  <p><span>å‘å¸ƒæ—¶é—´:</span>2015å¹´12æœˆ19æ—¥ - 00æ—¶00åˆ†</p>
  <p><span>æœ€åæ›´æ–°:</span>2016å¹´02æœˆ02æ—¥ - 11æ—¶14åˆ†</p>
  <p>
    <span>åŸå§‹é“¾æ¥:</span><a href="/2015/12/19/2015-12-19-HBase-BulkLoad/" title="HBase BulkLoad">http://github.com/zqhxuyuan/2015/12/19/2015-12-19-HBase-BulkLoad/</a>
    <span class="btn" data-clipboard-text="åŸæ–‡: http://github.com/zqhxuyuan/2015/12/19/2015-12-19-HBase-BulkLoad/ã€€ã€€ä½œè€…: ä»»ä½•å¿§ä¼¤,éƒ½æŠµä¸è¿‡ä¸–ç•Œçš„ç¾ä¸½" title="ç‚¹å‡»å¤åˆ¶æ–‡ç« é“¾æ¥">
        <i class="fa fa-clipboard"></i>
    </span>
  </p>
  <p><span>è®¸å¯åè®®:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" title="ä¸­å›½å¤§é™† (CC BY-NC-SA 3.0 CN)">"ç½²å-éå•†ç”¨-ç›¸åŒæ–¹å¼å…±äº« 3.0"</a> è½¬è½½è¯·ä¿ç•™åŸæ–‡é“¾æ¥åŠä½œè€…ã€‚</p>
  <script src="/js/clipboard.min.js"></script>
  <script> var clipboard = new Clipboard('.btn'); </script>
</div>
<style type="text/css">
  .copyright p .btn {
    margin-left: 1em;
  }
  .copyright:hover p .btn::after {
    content: "å¤åˆ¶"
  }
  .copyright p .btn:hover {
      color: gray;
      cursor: pointer;
    };
</style>



<nav id="article-nav">
  
    <div id="article-nav-newer" class="article-nav-title">
      <a href="/2015/12/21/2015-12-21-HBase-Query/">
        HBaseå¤šçº¿ç¨‹Queryä¼˜åŒ–æŸ¥è¯¢é€Ÿåº¦
      </a>
    </div>
  
  
    <div id="article-nav-older" class="article-nav-title">
      <a href="/2015/12/18/2015-12-18-Spark-HBase-RDD/">
        HBase-RDD
      </a>
    </div>
  
</nav>

  
  
    <div class ="post-donate">
	<br/>
	<p>
    <div id="donate_board" class="donate_bar center">
        <a id="btn_donate" class="btn_donate" href="javascript:;" title="æ‰“èµ"></a>
        <span class="donate_txt">
           &uarr;<br>
		   è¿™ä¹ˆé•¿çš„æ–‡ç« æˆ‘éƒ½è¯»å®Œäº†ï¼Œçœ‹èµ·æ¥ä½œè€…å†™çš„å¾ˆè¾›è‹¦å“‡ï¼ç»™ä½œè€…èµæ¯å’–å•¡å–ï¼Œæ”¯æŒä½œè€…ç»§ç»­å†™ä½œğŸ˜
        </span>
        <br>
    </div>  
	<div id="donate_guide" class="donate_bar center hidden" >
		<img src="/img/zhifubao.png" alt="æ”¯ä»˜å®æ‰“èµ"> 
		<img src="/img/weixin.png" alt="å¾®ä¿¡æ‰“èµ">  
    </div>
	<script type="text/javascript">
		document.getElementById('btn_donate').onclick = function(){
			$('#donate_board').addClass('hidden');
			$('#donate_guide').removeClass('hidden');
		}
	</script>
</div>
  
</article>

<!-- é»˜è®¤æ˜¾ç¤ºæ–‡ç« ç›®å½•ï¼Œåœ¨æ–‡ç« ---å‰è¾“å…¥toc: falseå…³é—­ç›®å½• -->
<!-- Show TOC and tocButton in default, Hide TOC via putting "toc: false" before "---" at [post].md -->
<div id="toc" class="toc-article">
<strong class="toc-title">æ–‡ç« ç›®å½•</strong>
<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#HBase_BulkLoad"><span class="toc-number">1.</span> <span class="toc-text">HBase BulkLoad</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#HBase_&_MapReduce"><span class="toc-number">1.1.</span> <span class="toc-text">HBase & MapReduce</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MRä½œä¸šç”ŸæˆHFile"><span class="toc-number">1.2.</span> <span class="toc-text">MRä½œä¸šç”ŸæˆHFile</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MRä»»åŠ¡å†…å­˜ä¸è¶³"><span class="toc-number">1.3.</span> <span class="toc-text">MRä»»åŠ¡å†…å­˜ä¸è¶³</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MRä»»åŠ¡å†…å­˜è°ƒä¼˜"><span class="toc-number">1.4.</span> <span class="toc-text">MRä»»åŠ¡å†…å­˜è°ƒä¼˜</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ç”ŸæˆHFileæ–‡ä»¶"><span class="toc-number">1.5.</span> <span class="toc-text">ç”ŸæˆHFileæ–‡ä»¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#å¯¼å…¥HBaseé›†ç¾¤å’ŒéªŒè¯æ•°æ®"><span class="toc-number">1.6.</span> <span class="toc-text">å¯¼å…¥HBaseé›†ç¾¤å’ŒéªŒè¯æ•°æ®</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#å¢åŠ (æ‰‹æœºå·)æ–°æ•°æ®æµç¨‹"><span class="toc-number">1.7.</span> <span class="toc-text">å¢åŠ (æ‰‹æœºå·)æ–°æ•°æ®æµç¨‹</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#éªŒè¯æ–°å¢æ•°æ®"><span class="toc-number">1.7.1.</span> <span class="toc-text">éªŒè¯æ–°å¢æ•°æ®</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ä¿®æ”¹å‰¯æœ¬æ•°"><span class="toc-number">1.8.</span> <span class="toc-text">ä¿®æ”¹å‰¯æœ¬æ•°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Ref"><span class="toc-number">1.9.</span> <span class="toc-text">Ref</span></a></li></ol></li></ol>
</div>
<style type="text/css">
  .left-col .switch-btn {
    display: none;
  }
  .left-col .switch-area {
    display: none;
  }
</style>

<input type="button" id="tocButton" value="éšè—ç›®å½•"  title="ç‚¹å‡»æŒ‰é’®éšè—æˆ–è€…æ˜¾ç¤ºæ–‡ç« ç›®å½•">
<script type="text/javascript">
  var toc_button= document.getElementById("tocButton");
  var toc_div= document.getElementById("toc");
  /* Show or hide toc when click on tocButton.
  é€šè¿‡ç‚¹å‡»è®¾ç½®çš„æŒ‰é’®æ˜¾ç¤ºæˆ–è€…éšè—æ–‡ç« ç›®å½•.*/
  toc_button.onclick=function(){
  if(toc_div.style.display=="none"){
  toc_div.style.display="block";
  toc_button.value="éšè—ç›®å½•";
  document.getElementById("switch-btn").style.display="none";
  document.getElementById("switch-area").style.display="none";
  }
  else{
  toc_div.style.display="none";
  toc_button.value="æ˜¾ç¤ºç›®å½•";
  document.getElementById("switch-btn").style.display="block";
  document.getElementById("switch-area").style.display="block";
  }
  }
    if ($(".toc").length < 1) {
        $("#toc").css("display","none");
        $("#tocButton").css("display","none");
        $(".switch-btn").css("display","block");
        $(".switch-area").css("display","block");
    }
</script>


    <style>
        .toc {
            white-space: nowrap;
            overflow-x: hidden;
        }
    </style>

    <script>
        $(document).ready(function() {
            $(".toc li a").mouseover(function() {
                var title = $(this).attr('href');
                $(this).attr("title", title);
            });
        })
    </script>




<div class="share">
	<div class="bdsharebuttonbox">
	<a href="#" class="bds_more" data-cmd="more"></a>
	<a href="#" class="bds_tsina" data-cmd="tsina" title="åˆ†äº«åˆ°æ–°æµªå¾®åš"></a>
	<a href="#" class="bds_sqq" data-cmd="sqq" title="åˆ†äº«ç»™ QQ å¥½å‹"></a>
	<a href="#" class="bds_copy" data-cmd="copy" title="å¤åˆ¶ç½‘å€"></a>
	<a href="#" class="bds_mail" data-cmd="mail" title="é€šè¿‡é‚®ä»¶åˆ†äº«"></a>
	<a href="#" class="bds_weixin" data-cmd="weixin" title="ç”Ÿæˆæ–‡ç« äºŒç»´ç "></a>
	</div>
	<script>
	window._bd_share_config={
		"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
	</script>
</div>



<div class="duoshuo" id="comments">
	<!-- å¤šè¯´è¯„è®ºæ¡† start -->
	<div class="ds-thread" data-thread-key="2015/12/19/2015-12-19-HBase-BulkLoad/" data-title="HBase BulkLoad" data-url="http://github.com/zqhxuyuan/2015/12/19/2015-12-19-HBase-BulkLoad/"></div>
	<!-- å¤šè¯´è¯„è®ºæ¡† end -->
	<!-- å¤šè¯´å…¬å…±JSä»£ç  start (ä¸€ä¸ªç½‘é¡µåªéœ€æ’å…¥ä¸€æ¬¡) -->
	<script type="text/javascript">
	var duoshuoQuery = {short_name:"zqhxuyuan"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
	<!-- å¤šè¯´å…¬å…±JSä»£ç  end -->
</div>






    <style type="text/css">
    #scroll {
      display: none;
    }
    </style>
    <div class="scroll">
    <a href="#" title="è¿”å›é¡¶éƒ¨"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" title="æŸ¥çœ‹è¯„è®º"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="è½¬åˆ°åº•éƒ¨"><i class="fa fa-arrow-down"></i></a>
    </div>


  
  
    
    <div  class="post-nav-button">
    <a href="/2015/12/21/2015-12-21-HBase-Query/" title="ä¸Šä¸€ç¯‡: HBaseå¤šçº¿ç¨‹Queryä¼˜åŒ–æŸ¥è¯¢é€Ÿåº¦">
    <i class="fa fa-angle-left"></i>
    </a>
    <a href="/2015/12/18/2015-12-18-Spark-HBase-RDD/" title="ä¸‹ä¸€ç¯‡: HBase-RDD">
    <i class="fa fa-angle-right"></i>
    </a>
    </div>
  



    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
        <script>
        var yiliaConfig = {
        fancybox: true,
        mathjax: true,
        animate: true,
        isHome: false,
        isPost: true,
        isArchive: false,
        isTag: false,
        isCategory: false,
        open_in_new: false
        }
        </script>
        
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2017 ä»»ä½•å¿§ä¼¤,éƒ½æŠµä¸è¿‡ä¸–ç•Œçš„ç¾ä¸½
      </div>
        <div class="footer-right">
          <a href="http://hexo.io/" target="_blank" title="å¿«é€Ÿã€ç®€æ´ä¸”é«˜æ•ˆçš„é™æ€åšå®¢æ¡†æ¶">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="ç®€è€Œä¸å‡åŒæ  Hexo åšå®¢ä¸»é¢˜">Yelee</a> by MOxFIVE
        </div>
    </div>
    <div class="visit">
      <span id="busuanzi_container_site_pv" style='display:none'>
        <span id="site-visit" >æœ¬ç«™åˆ°è®¿æ•°: 
        <span id="busuanzi_value_site_uv"></span>
        </span>
      </span>
      <span id="busuanzi_container_page_pv" style='display:none'>
        <span id="page-visit">, æœ¬é¡µé˜…è¯»é‡: 
        <span id="busuanzi_value_page_pv"></span>
        </span>
      </span>
    </div>
  </div>
</footer>
    </div>
    

<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>

<script>
  var backgroundnum = 5;
  var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));

  $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
</script>


<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-80646710-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<div class="scroll" id="scroll">
<a href="#" title="è¿”å›é¡¶éƒ¨"><i class="fa fa-arrow-up"></i></a>
<a href="#footer" title="è½¬åˆ°åº•éƒ¨"><i class="fa fa-arrow-down"></i></a>
</div>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>