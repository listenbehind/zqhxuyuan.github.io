<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>è¯‘ï¼šKafkaäº¤äº’å¼æŸ¥è¯¢å’Œæµå¤„ç†çš„ç»Ÿä¸€ | zqhxuyuan</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Unifying Stream Processing and Interactive Queries in Apache Kafkahttp://www.confluent.io/blog/unifying-stream-processing-and-interactive-queries-in-apache-kafka/">
<meta property="og:type" content="article">
<meta property="og:title" content="è¯‘ï¼šKafkaäº¤äº’å¼æŸ¥è¯¢å’Œæµå¤„ç†çš„ç»Ÿä¸€">
<meta property="og:url" content="http://github.com/zqhxuyuan/2016/10/29/Kafka-Interactive-Query/index.html">
<meta property="og:site_name" content="zqhxuyuan">
<meta property="og:description" content="Unifying Stream Processing and Interactive Queries in Apache Kafkahttp://www.confluent.io/blog/unifying-stream-processing-and-interactive-queries-in-apache-kafka/">
<meta property="og:image" content="http://www.confluent.io/wp-content/uploads/2016/10/IQueries-Blog-Diagrams-2-1-1024x381.png">
<meta property="og:updated_time" content="2016-10-27T05:52:51.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="è¯‘ï¼šKafkaäº¤äº’å¼æŸ¥è¯¢å’Œæµå¤„ç†çš„ç»Ÿä¸€">
<meta name="twitter:description" content="Unifying Stream Processing and Interactive Queries in Apache Kafkahttp://www.confluent.io/blog/unifying-stream-processing-and-interactive-queries-in-apache-kafka/">
  
    <link rel="alternative" href="/atom.xml" title="zqhxuyuan" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="https://avatars1.githubusercontent.com/u/1088525?v=3&amp;s=180" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">ä»»ä½•å¿§ä¼¤,éƒ½æŠµä¸è¿‡ä¸–ç•Œçš„ç¾ä¸½</a></h1>
		</hgroup>

		
				


		
			<div id="switch-btn" class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>èœå•</li>
						<li>æ ‡ç­¾</li>
						
						
						<li>å…³äºæˆ‘</li>
						
					</ul>
				</div>
			</div>
		

		<div id="switch-area" class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">ä¸»é¡µ</a></li>
				        
							<li><a href="/archives/">å½’æ¡£</a></li>
				        
							<li><a href="/tags/">æ ‡ç­¾</a></li>
				        
							<li><a href="/about/">å…³äº</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<ul class="social">
							
								<li id="æ–°æµªå¾®åš"><a class="æ–°æµªå¾®åš" target="_blank" href="http://weibo.com/xuyuantree" title="æ–°æµªå¾®åš"></a></li>
					        
								<li id="GitHub"><a class="GitHub" target="_blank" href="http://github.com/zqhxuyuan" title="GitHub"></a></li>
					        
								<li id="RSS"><a class="RSS" target="_blank" href="/atom.xml" title="RSS"></a></li>
					        
						</ul>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/akka/" style="font-size: 10px;">akka</a> <a href="/tags/apex/" style="font-size: 10px;">apex</a> <a href="/tags/bigdata/" style="font-size: 10px;">bigdata</a> <a href="/tags/cassandra/" style="font-size: 18.75px;">cassandra</a> <a href="/tags/clojure/" style="font-size: 10px;">clojure</a> <a href="/tags/drill/" style="font-size: 16.25px;">drill</a> <a href="/tags/druid/" style="font-size: 13.75px;">druid</a> <a href="/tags/elasticsearch/" style="font-size: 10px;">elasticsearch</a> <a href="/tags/etl/" style="font-size: 10px;">etl</a> <a href="/tags/geode/" style="font-size: 10px;">geode</a> <a href="/tags/graph/" style="font-size: 13.75px;">graph</a> <a href="/tags/hadoop/" style="font-size: 11.25px;">hadoop</a> <a href="/tags/hbase/" style="font-size: 15px;">hbase</a> <a href="/tags/ignite/" style="font-size: 10px;">ignite</a> <a href="/tags/jvm/" style="font-size: 10px;">jvm</a> <a href="/tags/kafka/" style="font-size: 20px;">kafka</a> <a href="/tags/midd/" style="font-size: 10px;">midd</a> <a href="/tags/ops/" style="font-size: 13.75px;">ops</a> <a href="/tags/redis/" style="font-size: 11.25px;">redis</a> <a href="/tags/rocketmq/" style="font-size: 10px;">rocketmq</a> <a href="/tags/scala/" style="font-size: 13.75px;">scala</a> <a href="/tags/spark/" style="font-size: 17.5px;">spark</a> <a href="/tags/storm/" style="font-size: 17.5px;">storm</a> <a href="/tags/timeseries/" style="font-size: 12.5px;">timeseries</a> <a href="/tags/work/" style="font-size: 13.75px;">work</a> <a href="/tags/æµå¤„ç†/" style="font-size: 11.25px;">æµå¤„ç†</a>
					</div>
				</section>
				
				
				

				
				
				<section class="switch-part switch-part3">
				
					<div id="js-aboutme">BIG(DATA)</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide"><a href="/" title="å›åˆ°ä¸»é¡µ">ä»»ä½•å¿§ä¼¤,éƒ½æŠµä¸è¿‡ä¸–ç•Œçš„ç¾ä¸½</a></h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<a href="/" class="profilepic">
				<img lazy-src="https://avatars1.githubusercontent.com/u/1088525?v=3&amp;s=180" class="js-avatar">
			</a>
			<hgroup>
			  <h1 class="header-author"><a href="/" title="å›åˆ°ä¸»é¡µ">ä»»ä½•å¿§ä¼¤,éƒ½æŠµä¸è¿‡ä¸–ç•Œçš„ç¾ä¸½</a></h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">ä¸»é¡µ</a></li>
		        
					<li><a href="/archives/">å½’æ¡£</a></li>
		        
					<li><a href="/tags/">æ ‡ç­¾</a></li>
		        
					<li><a href="/about/">å…³äº</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
						<ul class="social">
							
								<li id="æ–°æµªå¾®åš"><a class="æ–°æµªå¾®åš" target="_blank" href="http://weibo.com/xuyuantree" title="æ–°æµªå¾®åš"></a></li>
					        
								<li id="GitHub"><a class="GitHub" target="_blank" href="http://github.com/zqhxuyuan" title="GitHub"></a></li>
					        
								<li id="RSS"><a class="RSS" target="_blank" href="/atom.xml" title="RSS"></a></li>
					        
						</ul>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap"><article id="post-Kafka-Interactive-Query" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/10/29/Kafka-Interactive-Query/" class="article-date">
  	<time datetime="2016-10-28T16:00:00.000Z" itemprop="datePublished">2016-10-29</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      è¯‘ï¼šKafkaäº¤äº’å¼æŸ¥è¯¢å’Œæµå¤„ç†çš„ç»Ÿä¸€
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/kafka/">kafka</a>
	</div>


        
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kafka/">kafka</a></li></ul>
	</div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        
        <p>Unifying Stream Processing and Interactive Queries in Apache Kafka<br><a href="http://www.confluent.io/blog/unifying-stream-processing-and-interactive-queries-in-apache-kafka/" target="_blank" rel="external">http://www.confluent.io/blog/unifying-stream-processing-and-interactive-queries-in-apache-kafka/</a><br><a id="more"></a></p>
<p>Interactive Queries allows you to get more than just processing from streaming. It allows you to treat the stream processing layer as a lightweight, embedded database and directly query the state of your stream processing application, without needing to materialize that state to external databases or storage. Apache Kafka maintains and manages that state and guarantees high availability and fault tolerance. As such, this new feature enables the hyper-convergence of processing and storage into one easy-to-use application that uses the Apache Kafkaâ€™s Streams API.</p>
<blockquote>
<p>äº¤äº’å¼æŸ¥è¯¢ï¼ˆInteractive Queriesï¼‰å¹¶ä¸ä»…ä»…æ˜¯å¯¹æµæ•°æ®è¿›è¡Œå¤„ç†ï¼ˆstream processingï¼‰ï¼Œå®ƒç›¸å½“äºå°†æµå¤„ç†è¿™ä¸€å±‚çœ‹åšæ˜¯ä¸€ä¸ªè½»é‡çº§çš„ã€å†…ç½®çš„æ•°æ®åº“ã€ç›´æ¥æŸ¥è¯¢æµå¤„ç†åº”ç”¨ç¨‹åºçš„çŠ¶æ€ï¼Œå®ƒä¸éœ€è¦å°†çŠ¶æ€ï¼ˆæ•°æ®ï¼‰ç‰©åŒ–ï¼ˆmaterializeï¼‰åˆ°å¤–éƒ¨æ•°æ®åº“æˆ–å­˜å‚¨ç³»ç»Ÿä¸­ã€‚Kafkaä¼šè‡ªå·±ç»´æŠ¤å’Œç®¡ç†çŠ¶æ€ï¼Œå¹¶ä¸”ä¿è¯äº†é«˜å¯ç”¨ã€å®¹é”™ã€‚è¿™ä¸ªæ–°ç‰¹æ€§ä½¿å¾—å¤„ç†é€»è¾‘å˜å¾—é«˜åº¦èšåˆï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç”¨Kafkaçš„Streams APIå­˜å‚¨ï¼ˆçŠ¶æ€ï¼‰åˆ°ä¸€ä¸ªæ˜“ç”¨çš„åº”ç”¨ç¨‹åºä¸­ã€‚  </p>
</blockquote>
<p>The idea behind Interactive Queries is not new; a similar concept actually originated in traditional databases where itâ€™s often known as â€œmaterialized views.â€ Though materialized views are very useful, the way they are implemented in databases is not suitable for modern application development â€“ they force you to write your code all in SQL and deploy it into the database server. With our database background combined with our stream processing experience, we visited a key question: can the concept behind materialized views be applied to a modern stream processing engine to create a powerful and general purpose construct for building stateful applications and microservices? In this blog post, we show how Apache Kafka, through Interactive Queries, helps us do exactly that.</p>
<blockquote>
<p>äº¤äº’å¼æŸ¥è¯¢èƒŒåçš„æ€æƒ³å¹¶ä¸æ–°é²œï¼Œåœ¨ä¼ ç»Ÿçš„æ•°æ®åº“ä¸­ç›¸ä¼¼çš„æ¦‚å¿µæ˜¯â€œç‰©åŒ–è§†å›¾â€ï¼Œå°½ç®¡ç‰©åŒ–è§†å›¾éå¸¸æœ‰ç”¨ï¼Œä½†æ˜¯æ•°æ®åº“çš„è¿™ç§å®ç°æ–¹å¼å¯¹ç°ä»£çš„åº”ç”¨ç¨‹åºå¼€å‘å¹¶ä¸é€‚åˆï¼ˆå› ä¸ºä»–ä»¬ä¼šå¼ºåˆ¶ä½ åœ¨SQLä¸­ç¼–å†™æ‰€æœ‰çš„ä»£ç ï¼Œå¹¶éƒ¨ç½²åˆ°æœåŠ¡ç«¯ï¼‰ã€‚ç»“åˆæ•°æ®åº“çš„èƒŒæ™¯çŸ¥è¯†å’Œæµå¤„ç†çš„ä½“éªŒï¼Œæˆ‘ä»¬åœ¨æ€è€ƒä¸€ä¸ªå…³é”®çš„é—®é¢˜ï¼šç‰©åŒ–è§†å›¾æ˜¯å¦å¦‚æœåº”ç”¨åˆ°ç°ä»£çš„æµå¤„ç†å¼•æ“ï¼Œå°±å¯ä»¥æ„å»ºå‡ºä¸€ä¸ªå¼ºå£®çš„ã€é€šç”¨çš„ï¼Œæœ‰çŠ¶æ€çš„åº”ç”¨ç¨‹åºï¼ˆæˆ–è€…å¾®æœåŠ¡ï¼‰ï¼Œæœ¬ç¯‡åšæ–‡æˆ‘ä»¬ä¼šå‘ä½ å±•ç¤ºApache Kafkaå¦‚ä½•é€šè¿‡äº¤äº’å¼æŸ¥è¯¢å¸®åŠ©æˆ‘ä»¬å®ç°äº†è¿™ä¸ªç›®æ ‡ã€‚  </p>
</blockquote>
<p>When we set out to design the stream processing API for Apache Kafka â€“ Kafka Streams â€“ a key motivation was to rethink the existing solution space for stream processing. Here, our vision has been to move stream processing out of the big data niche and make it available as a mainstream application development model. For us, the key to executing that vision is to radically simplify how users can process data at any scale â€“ small, medium, large â€“ and in fact, one of our mantras is â€œBuild Applications, Not Clusters!â€ In the past, we wrote about three ways Apache Kafka simplifies the stream processing architecture â€“ by eliminating the need for a separate cluster, having good abstractions for streams and tables and keeping the overall architecture simple. Interactive Queries is another feature to enable this vision.</p>
<blockquote>
<p>åœ¨ä¸ºKafkaè®¾è®¡æµå¼å¤„ç†APIæ—¶ï¼ˆå³Kafka Streamsï¼‰ï¼Œä¸€ä¸ªé‡è¦çš„åŠ¨æœºæ˜¯é‡æ–°æ€è€ƒå·²æœ‰çš„æµå¤„ç†ç³»ç»Ÿçš„å±€é™æ€§ï¼Œæˆ‘ä»¬çš„ç„¦ç‚¹å·²ç»ä»å¤§æ•°æ®é¢†åŸŸè½¬åˆ°äº†æµå¤„ç†ï¼Œå¹¶ä¸”å°†å…¶ä½œä¸ºå¯ç”¨çš„ä¸»æµçš„åº”ç”¨ç¨‹åºå¼€å‘æ¨¡å‹ã€‚æ‰§è¡Œè¿™ä¸ªæ„¿æ™¯çš„å…³é”®æ˜¯ä»æ ¹æœ¬ä¸Šç®€åŒ–ç”¨æˆ·å¦‚ä½•å¤„ç†æ•°æ®çš„æ‰©å±•æ€§é—®é¢˜ï¼ˆä¸ç®¡æ˜¯å°æ‰¹é‡çš„æ•°æ®ã€ä¸­ç­‰è§„æ¨¡çš„ã€å¤§è§„æ¨¡çš„æ•°æ®ï¼‰ï¼Œå®é™…ä¸Šæˆ‘ä»¬çš„ä¸€ä¸ªå£å·æ˜¯ï¼šâ€œæ„å»ºåº”ç”¨ç¨‹åºï¼Œä¸è¦é›†ç¾¤ï¼â€ã€‚ä¹‹å‰çš„åšæ–‡ä¸­æˆ‘ä»¬å†™äº†Kafkaç®€åŒ–æµå¤„ç†çš„<a href="http://www.confluent.io/blog/introducing-kafka-streams-stream-processing-made-simple/" target="_blank" rel="external">ä¸‰ç§æ¨¡å¼</a>ï¼šä¸éœ€è¦å•ç‹¬çš„é›†ç¾¤ã€å¯¹Streamså’ŒTableè¿›è¡Œè‰¯å¥½çš„æŠ½è±¡ã€ä¿æŒæ•´ä½“æ¶æ„çš„ç®€æ´ã€‚ç°åœ¨ï¼Œäº¤äº’å¼æŸ¥è¯¢æ˜¯è¿™ä¸ªæ„¿æ™¯çš„å¦ä¸€ä¸ªç‰¹æ€§ã€‚</p>
</blockquote>
<p>In this blog post, weâ€™ll start by digging deeper into the motivation behind Interactive Queries through a concrete example that outlines its applicability. Then we will describe how Interactive Queries works under the hood and provide a summary of related resources for further reading.</p>
<blockquote>
<p>æœ¬ç¯‡æ–‡ç« æˆ‘ä»¬ä¼šå…ˆé€šè¿‡ä¸€ä¸ªç¤ºä¾‹æ·±å…¥ç ”ç©¶äº¤äº’å¼æŸ¥è¯¢çš„èƒŒååŠ¨æœºï¼Œç„¶åä¼šæè¿°äº¤äº’å¼æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</p>
</blockquote>
<h2 id="ç¤ºä¾‹ï¼šå®æ—¶é£é™©ç®¡ç†">ç¤ºä¾‹ï¼šå®æ—¶é£é™©ç®¡ç†</h2><p>Letâ€™s use an end-to-end example to pick up where we left off in our previous article on why stream processing applications need state. In that article, we described some simple stateful operations, e.g., if you are grouping data by some field and counting, then the state you maintain would be the counts that have accumulated so far. Or if you are joining two streams, the state would be the rows in each stream waiting to find a match in the other stream.</p>
<blockquote>
<p>åœ¨<a href="https://www.oreilly.com/ideas/why-local-state-is-a-fundamental-primitive-in-stream-processing" target="_blank" rel="external">æµå¤„ç†ä¸ºä»€ä¹ˆéœ€è¦çŠ¶æ€</a>æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬æè¿°äº†ä¸€äº›ç®€å•çš„çŠ¶æ€æ“ä½œï¼Œæ¯”å¦‚æ ¹æ®ä¸€äº›å­—æ®µåˆ†ç»„å’Œè®¡æ•°ï¼Œé‚£ä¹ˆä½ ç»´æŠ¤çš„çŠ¶æ€å°±æ˜¯ç›®å‰ä¸ºæ­¢æ”¶é›†åˆ°çš„æ‰€æœ‰æ•°æ®çš„æ•°é‡ã€‚æˆ–è€…å¦‚æœå°†ä¸¤ä¸ªæµè¿›è¡Œåˆå¹¶ï¼ŒçŠ¶æ€å°±ä¼šæ˜¯åœ¨ä¸¤ä¸ªæµä¸­æ‰¾å‡ºäº’ç›¸åŒ¹é…çš„ä¸€è¡Œè®°å½•ï¼ˆç”±äºæµæ•°æ®çš„é¡ºåºæ€§ï¼Œä¸€ä¸ªæµè¦ç­‰å¾…å¦ä¸€ä¸ªæµï¼Œæ‰èƒ½æœ€ç»ˆè·å¾—å®Œæ•´çš„åˆå¹¶æ•°æ®ï¼‰ã€‚</p>
</blockquote>
<p>Now as a driving example in this blog, consider a financial institution, like a wealth management firm or a hedge fund, that maintains positions in assets held by the firm and/or its client investors. Maintaining positions means that the bank needs to keep track of the risk associated with those particular assets. The bank continuously collects business events and other data that could potentially influence the risk associated with a given position. This data includes market data fluctuations on the price of the asset, foreign exchange rates, research, or even news information that could influence the reputation of people involved with the asset. Any time this data changes, the risk position needs to be recalculated in order to keep a real-time view of the risk associated with each individual asset as well as on entire portfolios of investments.</p>
<p>Real-time risk management is an example of a stateful application. At a minimum, state is needed to keep track of the latest position for every asset. State is also needed inside the stream processing engine to keep track of various aggregate statistics, like the number of times an asset is traded in a day and the average bid/ask spread. The collected state needs to be continuously updated and queried.</p>
<blockquote>
<p>æœ¬ç¯‡åšæ–‡ä¸¾ä¾‹çš„æ˜¯ä¸€ä¸ªé‡‘èåœºæ™¯ï¼Œæ¯”å¦‚è´¢å¯Œç®¡ç†æœºæ„æˆ–è€…å¯¹å†²åŸºé‡‘ï¼ˆæŠ•èµ„è€…ï¼‰ä¼šç»´æŠ¤èµ„äº§çš„ä»“ä½ã€‚ç»´æŠ¤ä»“ä½æ„å‘³ç€é“¶è¡Œä¼šè·Ÿè¸ªè¿™äº›èµ„äº§çš„é£é™©ã€‚é“¶è¡Œä¼šæŒç»­åœ°æ”¶é›†å•†ä¸šäº‹ä»¶ä»¥åŠå…¶ä»–å¯èƒ½ä¼šå½±å“æŒ‡å®šä»“ä½é£é™©çš„æ•°æ®ã€‚è¿™äº›æ•°æ®åŒ…æ‹¬èµ„äº§çš„å¸‚åœºæ³¢åŠ¨ï¼Œå¤–æ±‡äº¤æ¢æ¯”ç‡ï¼Œç ”ç©¶æœºæ„ï¼Œç”šè‡³æ˜¯æœ‰å£°æœ›çš„åäººçš„æ–°é—»ã€‚ä»»ä½•æ—¶å€™åªè¦æ•°æ®å˜åŒ–ï¼Œé£é™©çš„ä»“ä½å°±éœ€è¦è¢«é‡æ–°è®¡ç®—ï¼Œè¿™æ ·æ‰èƒ½å¯¹å•ç‹¬çš„èµ„äº§ï¼Œç”šè‡³æ•´ä¸ªæŠ•èµ„ç»„åˆéƒ½èƒ½å¤Ÿä¿æŒå®æ—¶çš„é£é™©è§†å›¾ã€‚<br>å®æ—¶é£æ§ç®¡ç†æ˜¯æœ‰çŠ¶æ€çš„åº”ç”¨ç¨‹åºçš„ä¸€ä¸ªç¤ºä¾‹ï¼Œæœ€å°çš„éœ€æ±‚æ˜¯ï¼šçŠ¶æ€éœ€è¦èƒ½å¤Ÿè·Ÿè¸ªæ¯ç§èµ„äº§çš„æœ€è¿‘ä»“ä½ã€‚çŠ¶æ€åœ¨æµå¤„ç†å¼•æ“ä¸­ä¸ºäº†è·Ÿè¸ªä¸åŒçš„èšåˆé€»è¾‘ä¹Ÿæ˜¯å¿…é¡»çš„ï¼Œæ¯”å¦‚ä¸€å¤©ä¸­èµ„äº§çš„äº¤æ˜“æ¬¡æ•°ï¼Œå¹³å‡å‡ºä»·(bid/ask)é€Ÿåº¦ã€‚æ”¶é›†åˆ°çš„çŠ¶æ€éœ€è¦è¢«æŒç»­åœ°æ›´æ–°å’ŒæŸ¥è¯¢ã€‚  </p>
</blockquote>
<h2 id="ç°åœ¨çš„åšæ³•">ç°åœ¨çš„åšæ³•</h2><p>åœ¨æ²¡æœ‰Kafka Streamsä¹‹å‰ï¼Œå…¸å‹çš„æ¶æ„å›¾å¦‚ä¸‹ï¼š<br><img src="http://www.confluent.io/wp-content/uploads/2016/10/IQueries-Blog-Diagrams-2-1-1024x381.png" alt="arch before"></p>
<p>å›¾ä¸­ä¸šåŠ¡äº‹ä»¶ä¼šè¢«Kafkaæ•è·ï¼Œä¸Šéƒ¨åˆ†æ˜¯Hadoop/Sparkæ‰¹å¤„ç†ç³»ç»Ÿï¼Œä¸‹éƒ¨åˆ†æ˜¯æµå¤„ç†ç³»ç»Ÿï¼Œè¿™ç§æ··åˆéƒ¨ç½²æ¨¡å¼ä¹Ÿè¢«ç§°ä½œLambdaæ¶æ„ï¼Œå®ƒçš„ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼šéœ€è¦ç»´æŠ¤ç›‘æ§ä¸¤å¥—ç³»ç»Ÿï¼Œæ€»ç»“ç°åœ¨çš„é€šç”¨åšæ³•ï¼š  </p>
<ol>
<li>ä¸€ä¸ªé¢å¤–çš„Hadoopé›†ç¾¤é‡å¤å¤„ç†æ•°æ®</li>
<li>åœ¨æµå¤„ç†å±‚ä¹Ÿè¦ç»´æŠ¤å­˜å‚¨ï¼Œå› ä¸ºæµå¤„ç†éœ€è¦æŸ¥è¯¢å’Œèšåˆ</li>
<li>æµå¤„ç†ä½œä¸šå’Œæ‰¹å¤„ç†ä½œä¸šçš„è¾“å‡ºéƒ½éœ€è¦ç»´æŠ¤å­˜å‚¨å’Œæ•°æ®åº“</li>
<li>å†™æ”¾å¤§æ— æ³•é¿å…ï¼Œ</li>
</ol>

      
    </div>
    
  </div>
  
    
<div class="copyright">
  <p><span>æœ¬æ–‡æ ‡é¢˜:</span><a href="/2016/10/29/Kafka-Interactive-Query/">è¯‘ï¼šKafkaäº¤äº’å¼æŸ¥è¯¢å’Œæµå¤„ç†çš„ç»Ÿä¸€</a></p>
  <p><span>æ–‡ç« ä½œè€…:</span><a href="/" title="è®¿é—® ä»»ä½•å¿§ä¼¤,éƒ½æŠµä¸è¿‡ä¸–ç•Œçš„ç¾ä¸½ çš„ä¸ªäººåšå®¢">ä»»ä½•å¿§ä¼¤,éƒ½æŠµä¸è¿‡ä¸–ç•Œçš„ç¾ä¸½</a></p>
  <p><span>å‘å¸ƒæ—¶é—´:</span>2016å¹´10æœˆ29æ—¥ - 00æ—¶00åˆ†</p>
  <p><span>æœ€åæ›´æ–°:</span>2016å¹´10æœˆ27æ—¥ - 13æ—¶52åˆ†</p>
  <p>
    <span>åŸå§‹é“¾æ¥:</span><a href="/2016/10/29/Kafka-Interactive-Query/" title="è¯‘ï¼šKafkaäº¤äº’å¼æŸ¥è¯¢å’Œæµå¤„ç†çš„ç»Ÿä¸€">http://github.com/zqhxuyuan/2016/10/29/Kafka-Interactive-Query/</a>
    <span class="btn" data-clipboard-text="åŸæ–‡: http://github.com/zqhxuyuan/2016/10/29/Kafka-Interactive-Query/ã€€ã€€ä½œè€…: ä»»ä½•å¿§ä¼¤,éƒ½æŠµä¸è¿‡ä¸–ç•Œçš„ç¾ä¸½" title="ç‚¹å‡»å¤åˆ¶æ–‡ç« é“¾æ¥">
        <i class="fa fa-clipboard"></i>
    </span>
  </p>
  <p><span>è®¸å¯åè®®:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" title="ä¸­å›½å¤§é™† (CC BY-NC-SA 3.0 CN)">"ç½²å-éå•†ç”¨-ç›¸åŒæ–¹å¼å…±äº« 3.0"</a> è½¬è½½è¯·ä¿ç•™åŸæ–‡é“¾æ¥åŠä½œè€…ã€‚</p>
  <script src="/js/clipboard.min.js"></script>
  <script> var clipboard = new Clipboard('.btn'); </script>
</div>
<style type="text/css">
  .copyright p .btn {
    margin-left: 1em;
  }
  .copyright:hover p .btn::after {
    content: "å¤åˆ¶"
  }
  .copyright p .btn:hover {
      color: gray;
      cursor: pointer;
    };
</style>



<nav id="article-nav">
  
    <div id="article-nav-newer" class="article-nav-title">
      <a href="/2016/10/29/Kafka-Definitive-Guide-cn-03/">
        è¯‘ï¼šKafkaæƒå¨æŒ‡å—-ç¬¬3ç« -ç”Ÿäº§è€…
      </a>
    </div>
  
  
    <div id="article-nav-older" class="article-nav-title">
      <a href="/2016/10/29/Kafka-Definitive-Guide-cn-06/">
        è¯‘ï¼šKafkaæƒå¨æŒ‡å—-ç¬¬6ç« -å¯é çš„æ•°æ®ä¼ é€’
      </a>
    </div>
  
</nav>

  
  
    <div class ="post-donate">
	<br/>
	<p>
    <div id="donate_board" class="donate_bar center">
        <a id="btn_donate" class="btn_donate" href="javascript:;" title="æ‰“èµ"></a>
        <span class="donate_txt">
           &uarr;<br>
		   è¿™ä¹ˆé•¿çš„æ–‡ç« æˆ‘éƒ½è¯»å®Œäº†ï¼Œçœ‹èµ·æ¥ä½œè€…å†™çš„å¾ˆè¾›è‹¦å“‡ï¼ç»™ä½œè€…èµæ¯å’–å•¡å–ï¼Œæ”¯æŒä½œè€…ç»§ç»­å†™ä½œğŸ˜
        </span>
        <br>
    </div>  
	<div id="donate_guide" class="donate_bar center hidden" >
		<img src="/img/zhifubao.png" alt="æ”¯ä»˜å®æ‰“èµ"> 
		<img src="/img/weixin.png" alt="å¾®ä¿¡æ‰“èµ">  
    </div>
	<script type="text/javascript">
		document.getElementById('btn_donate').onclick = function(){
			$('#donate_board').addClass('hidden');
			$('#donate_guide').removeClass('hidden');
		}
	</script>
</div>
  
</article>

<!-- é»˜è®¤æ˜¾ç¤ºæ–‡ç« ç›®å½•ï¼Œåœ¨æ–‡ç« ---å‰è¾“å…¥toc: falseå…³é—­ç›®å½• -->
<!-- Show TOC and tocButton in default, Hide TOC via putting "toc: false" before "---" at [post].md -->
<div id="toc" class="toc-article">
<strong class="toc-title">æ–‡ç« ç›®å½•</strong>
<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#ç¤ºä¾‹ï¼šå®æ—¶é£é™©ç®¡ç†"><span class="toc-number">1.</span> <span class="toc-text">ç¤ºä¾‹ï¼šå®æ—¶é£é™©ç®¡ç†</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ç°åœ¨çš„åšæ³•"><span class="toc-number">2.</span> <span class="toc-text">ç°åœ¨çš„åšæ³•</span></a></li></ol>
</div>
<style type="text/css">
  .left-col .switch-btn {
    display: none;
  }
  .left-col .switch-area {
    display: none;
  }
</style>

<input type="button" id="tocButton" value="éšè—ç›®å½•"  title="ç‚¹å‡»æŒ‰é’®éšè—æˆ–è€…æ˜¾ç¤ºæ–‡ç« ç›®å½•">
<script type="text/javascript">
  var toc_button= document.getElementById("tocButton");
  var toc_div= document.getElementById("toc");
  /* Show or hide toc when click on tocButton.
  é€šè¿‡ç‚¹å‡»è®¾ç½®çš„æŒ‰é’®æ˜¾ç¤ºæˆ–è€…éšè—æ–‡ç« ç›®å½•.*/
  toc_button.onclick=function(){
  if(toc_div.style.display=="none"){
  toc_div.style.display="block";
  toc_button.value="éšè—ç›®å½•";
  document.getElementById("switch-btn").style.display="none";
  document.getElementById("switch-area").style.display="none";
  }
  else{
  toc_div.style.display="none";
  toc_button.value="æ˜¾ç¤ºç›®å½•";
  document.getElementById("switch-btn").style.display="block";
  document.getElementById("switch-area").style.display="block";
  }
  }
    if ($(".toc").length < 1) {
        $("#toc").css("display","none");
        $("#tocButton").css("display","none");
        $(".switch-btn").css("display","block");
        $(".switch-area").css("display","block");
    }
</script>


    <style>
        .toc {
            white-space: nowrap;
            overflow-x: hidden;
        }
    </style>

    <script>
        $(document).ready(function() {
            $(".toc li a").mouseover(function() {
                var title = $(this).attr('href');
                $(this).attr("title", title);
            });
        })
    </script>




<div class="share">
	<div class="bdsharebuttonbox">
	<a href="#" class="bds_more" data-cmd="more"></a>
	<a href="#" class="bds_tsina" data-cmd="tsina" title="åˆ†äº«åˆ°æ–°æµªå¾®åš"></a>
	<a href="#" class="bds_sqq" data-cmd="sqq" title="åˆ†äº«ç»™ QQ å¥½å‹"></a>
	<a href="#" class="bds_copy" data-cmd="copy" title="å¤åˆ¶ç½‘å€"></a>
	<a href="#" class="bds_mail" data-cmd="mail" title="é€šè¿‡é‚®ä»¶åˆ†äº«"></a>
	<a href="#" class="bds_weixin" data-cmd="weixin" title="ç”Ÿæˆæ–‡ç« äºŒç»´ç "></a>
	</div>
	<script>
	window._bd_share_config={
		"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
	</script>
</div>



<div class="duoshuo" id="comments">
	<!-- å¤šè¯´è¯„è®ºæ¡† start -->
	<div class="ds-thread" data-thread-key="2016/10/29/Kafka-Interactive-Query/" data-title="è¯‘ï¼šKafkaäº¤äº’å¼æŸ¥è¯¢å’Œæµå¤„ç†çš„ç»Ÿä¸€" data-url="http://github.com/zqhxuyuan/2016/10/29/Kafka-Interactive-Query/"></div>
	<!-- å¤šè¯´è¯„è®ºæ¡† end -->
	<!-- å¤šè¯´å…¬å…±JSä»£ç  start (ä¸€ä¸ªç½‘é¡µåªéœ€æ’å…¥ä¸€æ¬¡) -->
	<script type="text/javascript">
	var duoshuoQuery = {short_name:"zqhxuyuan"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
	<!-- å¤šè¯´å…¬å…±JSä»£ç  end -->
</div>






    <style type="text/css">
    #scroll {
      display: none;
    }
    </style>
    <div class="scroll">
    <a href="#" title="è¿”å›é¡¶éƒ¨"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" title="æŸ¥çœ‹è¯„è®º"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="è½¬åˆ°åº•éƒ¨"><i class="fa fa-arrow-down"></i></a>
    </div>


  
  
    
    <div  class="post-nav-button">
    <a href="/2016/10/29/Kafka-Definitive-Guide-cn-03/" title="ä¸Šä¸€ç¯‡: è¯‘ï¼šKafkaæƒå¨æŒ‡å—-ç¬¬3ç« -ç”Ÿäº§è€…">
    <i class="fa fa-angle-left"></i>
    </a>
    <a href="/2016/10/29/Kafka-Definitive-Guide-cn-06/" title="ä¸‹ä¸€ç¯‡: è¯‘ï¼šKafkaæƒå¨æŒ‡å—-ç¬¬6ç« -å¯é çš„æ•°æ®ä¼ é€’">
    <i class="fa fa-angle-right"></i>
    </a>
    </div>
  



    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
        <script>
        var yiliaConfig = {
        fancybox: true,
        mathjax: true,
        animate: true,
        isHome: false,
        isPost: true,
        isArchive: false,
        isTag: false,
        isCategory: false,
        open_in_new: false
        }
        </script>
        
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2017 ä»»ä½•å¿§ä¼¤,éƒ½æŠµä¸è¿‡ä¸–ç•Œçš„ç¾ä¸½
      </div>
        <div class="footer-right">
          <a href="http://hexo.io/" target="_blank" title="å¿«é€Ÿã€ç®€æ´ä¸”é«˜æ•ˆçš„é™æ€åšå®¢æ¡†æ¶">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="ç®€è€Œä¸å‡åŒæ  Hexo åšå®¢ä¸»é¢˜">Yelee</a> by MOxFIVE
        </div>
    </div>
    <div class="visit">
      <span id="busuanzi_container_site_pv" style='display:none'>
        <span id="site-visit" >æœ¬ç«™åˆ°è®¿æ•°: 
        <span id="busuanzi_value_site_uv"></span>
        </span>
      </span>
      <span id="busuanzi_container_page_pv" style='display:none'>
        <span id="page-visit">, æœ¬é¡µé˜…è¯»é‡: 
        <span id="busuanzi_value_page_pv"></span>
        </span>
      </span>
    </div>
  </div>
</footer>
    </div>
    

<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>

<script>
  var backgroundnum = 5;
  var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));

  $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
</script>


<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-80646710-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<div class="scroll" id="scroll">
<a href="#" title="è¿”å›é¡¶éƒ¨"><i class="fa fa-arrow-up"></i></a>
<a href="#footer" title="è½¬åˆ°åº•éƒ¨"><i class="fa fa-arrow-down"></i></a>
</div>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>