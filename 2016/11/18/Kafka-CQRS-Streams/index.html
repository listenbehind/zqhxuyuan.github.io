<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>è¯‘ï¼šKafkaäº‹ä»¶é©±åŠ¨å’Œæµå¤„ç† | zqhxuyuan</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="http://www.confluent.io/blog/event-sourcing-cqrs-stream-processing-apache-kafka-whats-connection/">
<meta property="og:type" content="article">
<meta property="og:title" content="è¯‘ï¼šKafkaäº‹ä»¶é©±åŠ¨å’Œæµå¤„ç†">
<meta property="og:url" content="http://github.com/zqhxuyuan/2016/11/18/Kafka-CQRS-Streams/index.html">
<meta property="og:site_name" content="zqhxuyuan">
<meta property="og:description" content="http://www.confluent.io/blog/event-sourcing-cqrs-stream-processing-apache-kafka-whats-connection/">
<meta property="og:image" content="http://www.confluent.io/wp-content/uploads/2016/09/Event-sourced-based-architecture.jpeg">
<meta property="og:updated_time" content="2016-10-29T03:50:13.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="è¯‘ï¼šKafkaäº‹ä»¶é©±åŠ¨å’Œæµå¤„ç†">
<meta name="twitter:description" content="http://www.confluent.io/blog/event-sourcing-cqrs-stream-processing-apache-kafka-whats-connection/">
  
    <link rel="alternative" href="/atom.xml" title="zqhxuyuan" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="https://avatars1.githubusercontent.com/u/1088525?v=3&amp;s=180" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">ä»»ä½•å¿§ä¼¤,éƒ½æŠµä¸è¿‡ä¸–ç•Œçš„ç¾ä¸½</a></h1>
		</hgroup>

		
				


		
			<div id="switch-btn" class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>èœå•</li>
						<li>æ ‡ç­¾</li>
						
						
						<li>å…³äºæˆ‘</li>
						
					</ul>
				</div>
			</div>
		

		<div id="switch-area" class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">ä¸»é¡µ</a></li>
				        
							<li><a href="/archives/">å½’æ¡£</a></li>
				        
							<li><a href="/tags/">æ ‡ç­¾</a></li>
				        
							<li><a href="/about/">å…³äº</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<ul class="social">
							
								<li id="æ–°æµªå¾®åš"><a class="æ–°æµªå¾®åš" target="_blank" href="http://weibo.com/xuyuantree" title="æ–°æµªå¾®åš"></a></li>
					        
								<li id="GitHub"><a class="GitHub" target="_blank" href="http://github.com/zqhxuyuan" title="GitHub"></a></li>
					        
								<li id="RSS"><a class="RSS" target="_blank" href="/atom.xml" title="RSS"></a></li>
					        
						</ul>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/akka/" style="font-size: 10px;">akka</a> <a href="/tags/apex/" style="font-size: 10px;">apex</a> <a href="/tags/bigdata/" style="font-size: 10px;">bigdata</a> <a href="/tags/book/" style="font-size: 10px;">book</a> <a href="/tags/cassandra/" style="font-size: 18.75px;">cassandra</a> <a href="/tags/clojure/" style="font-size: 10px;">clojure</a> <a href="/tags/drill/" style="font-size: 16.25px;">drill</a> <a href="/tags/druid/" style="font-size: 13.75px;">druid</a> <a href="/tags/dubbo/" style="font-size: 10px;">dubbo</a> <a href="/tags/elasticsearch/" style="font-size: 10px;">elasticsearch</a> <a href="/tags/etl/" style="font-size: 10px;">etl</a> <a href="/tags/geode/" style="font-size: 10px;">geode</a> <a href="/tags/graph/" style="font-size: 13.75px;">graph</a> <a href="/tags/hadoop/" style="font-size: 11.25px;">hadoop</a> <a href="/tags/hbase/" style="font-size: 15px;">hbase</a> <a href="/tags/ignite/" style="font-size: 10px;">ignite</a> <a href="/tags/java/" style="font-size: 10px;">java</a> <a href="/tags/jvm/" style="font-size: 10px;">jvm</a> <a href="/tags/kafka/" style="font-size: 20px;">kafka</a> <a href="/tags/midd/" style="font-size: 11.25px;">midd</a> <a href="/tags/ops/" style="font-size: 13.75px;">ops</a> <a href="/tags/redis/" style="font-size: 11.25px;">redis</a> <a href="/tags/rocketmq/" style="font-size: 10px;">rocketmq</a> <a href="/tags/scala/" style="font-size: 13.75px;">scala</a> <a href="/tags/spark/" style="font-size: 17.5px;">spark</a> <a href="/tags/storm/" style="font-size: 17.5px;">storm</a> <a href="/tags/timeseries/" style="font-size: 12.5px;">timeseries</a> <a href="/tags/work/" style="font-size: 13.75px;">work</a> <a href="/tags/æµå¤„ç†/" style="font-size: 11.25px;">æµå¤„ç†</a>
					</div>
				</section>
				
				
				

				
				
				<section class="switch-part switch-part3">
				
					<div id="js-aboutme">BIG(DATA)</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide"><a href="/" title="å›åˆ°ä¸»é¡µ">ä»»ä½•å¿§ä¼¤,éƒ½æŠµä¸è¿‡ä¸–ç•Œçš„ç¾ä¸½</a></h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<a href="/" class="profilepic">
				<img lazy-src="https://avatars1.githubusercontent.com/u/1088525?v=3&amp;s=180" class="js-avatar">
			</a>
			<hgroup>
			  <h1 class="header-author"><a href="/" title="å›åˆ°ä¸»é¡µ">ä»»ä½•å¿§ä¼¤,éƒ½æŠµä¸è¿‡ä¸–ç•Œçš„ç¾ä¸½</a></h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">ä¸»é¡µ</a></li>
		        
					<li><a href="/archives/">å½’æ¡£</a></li>
		        
					<li><a href="/tags/">æ ‡ç­¾</a></li>
		        
					<li><a href="/about/">å…³äº</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
						<ul class="social">
							
								<li id="æ–°æµªå¾®åš"><a class="æ–°æµªå¾®åš" target="_blank" href="http://weibo.com/xuyuantree" title="æ–°æµªå¾®åš"></a></li>
					        
								<li id="GitHub"><a class="GitHub" target="_blank" href="http://github.com/zqhxuyuan" title="GitHub"></a></li>
					        
								<li id="RSS"><a class="RSS" target="_blank" href="/atom.xml" title="RSS"></a></li>
					        
						</ul>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap"><article id="post-Kafka-CQRS-Streams" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/11/18/Kafka-CQRS-Streams/" class="article-date">
  	<time datetime="2016-11-17T16:00:00.000Z" itemprop="datePublished">2016-11-18</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      è¯‘ï¼šKafkaäº‹ä»¶é©±åŠ¨å’Œæµå¤„ç†
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/kafka/">kafka</a>
	</div>


        
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kafka/">kafka</a></li></ul>
	</div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        
        <p><a href="http://www.confluent.io/blog/event-sourcing-cqrs-stream-processing-apache-kafka-whats-connection/" target="_blank" rel="external">http://www.confluent.io/blog/event-sourcing-cqrs-stream-processing-apache-kafka-whats-connection/</a><br><a id="more"></a></p>
<p>Event sourcing as an application architecture pattern is rising in popularity. Event sourcing involves modeling the state changes made by applications as an immutable sequence or â€œlogâ€ of events. Instead of modifying the state of the application in-place, event sourcing involves storing the event that triggers the state change in an immutable log and modeling the state changes as responses to the events in the log. We previously wrote about event sourcing, Apache Kafka and how they are related. In this post, I explore these ideas further and show how stream processing and, in particular, Kafka Streams helps to put Event sourcing and CQRS into practice.</p>
<blockquote>
<p>äº‹ä»¶é©±åŠ¨ï¼ˆEvent sourcingï¼‰ä½œä¸ºåº”ç”¨ç¨‹åºæ¶æ„çš„ä¸€ç§æ¨¡å¼ç°åœ¨è¶Šæ¥è¶Šæµè¡Œäº†ã€‚äº‹ä»¶é©±åŠ¨åŒ…æ‹¬äº†å°†åº”ç”¨ç¨‹åºäº§ç”Ÿçš„çŠ¶æ€æ”¹å˜æ•°æ®å»ºæ¨¡æˆä¸å¯å˜çš„åºåˆ—ã€æˆ–è€…è¯´æ˜¯äº‹ä»¶çš„æ—¥å¿—ã€‚å®ƒä¸æ˜¯ç›´æ¥å°±åœ°ä¿®æ”¹åº”ç”¨ç¨‹åºçš„çŠ¶æ€ï¼Œäº‹ä»¶é©±åŠ¨ä¼šå°†è§¦å‘çŠ¶æ€æ”¹å˜çš„äº‹ä»¶å­˜å‚¨åˆ°ä¸€ä¸ªä¸å¯å˜çš„æ—¥å¿—ï¼Œåœ¨æ—¥å¿—ä¸­å°†çŠ¶æ€æ”¹å˜å»ºæ¨¡æˆé’ˆå¯¹å‘ç”Ÿäº‹ä»¶çš„å“åº”ã€‚åœ¨<a href="http://www.confluent.io/blog/making-sense-of-stream-processing/" target="_blank" rel="external">ä¹‹å‰çš„æ–‡ç« </a>ä¸­ï¼Œæˆ‘ä»¬é˜è¿°äº†äº‹ä»¶é©±åŠ¨å’ŒKafkaçš„å…³ç³»ã€‚æœ¬ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬ä¼šæ›´è¿›ä¸€æ­¥æ¢ç´¢è¿™äº›æ€æƒ³ï¼Œå¹¶ä¸”ä¼šå±•ç¤ºæµå¤„ç†ï¼Œæ›´å‡†ç¡®çš„è¯´æ˜¯Kafka Streamsï¼Œæ€ä¹ˆå¸®åŠ©æˆ‘ä»¬å°†äº‹ä»¶é©±åŠ¨å’ŒCQRSè¿ç”¨åœ¨å®é™…ä¸­ã€‚  </p>
</blockquote>
<p>Letâ€™s take an example. Consider a Facebook-like social networking app (albeit a completely hypothetical one) that updates the profiles database when a user updates their Facebook profile. There are several applications that need to be notified when a user updates their profile â€” the search application so the userâ€™s profile can be reindexed to be searchable on the changed attribute; the newsfeed application so the userâ€™s connections can find out about the profile update; the data warehouse ETL application to load the latest profile data into the central data warehouse that powers various analytical queries and so on.</p>
<blockquote>
<p>ä¸¾ä¾‹ç±»ä¼¼äºFacebookè¿™æ ·çš„ç¤¾äº¤ç½‘ç»œåº”ç”¨ï¼Œå½“ç”¨æˆ·åœ¨Facebookçš„è®¾ç½®é¡µé¢æ›´æ–°è‡ªå·±çš„ä¿¡æ¯æ—¶ä¼šæ›´æ–°profilesæ•°æ®åº“ã€‚æœ‰å¾ˆå¤šåº”ç”¨å› ä¸ºå’Œä¸ªäººä¿¡æ¯ç›¸å…³ï¼Œåœ¨ç”¨æˆ·æ›´æ–°ä»–ä»¬çš„è®¾ç½®æ—¶ï¼Œè¿™äº›åº”ç”¨éƒ½éœ€è¦è¢«é€šçŸ¥åˆ°ã€‚æ¯”å¦‚é€šçŸ¥æœç´¢åº”ç”¨ï¼Œç”¨æˆ·çš„è®¾ç½®å¯ä»¥è¢«é‡æ–°ç´¢å¼•ï¼Œè¢«æ”¹å˜çš„å±æ€§å°±å¯ä»¥è¢«æœç´¢å‡ºæ¥ï¼›é€šçŸ¥æ–°é—»è®¢é˜…åº”ç”¨ï¼Œè¿™æ ·ç”¨æˆ·çš„è¿æ¥å°±å¯ä»¥æ‰¾å‡ºè¢«æ›´æ–°è¿‡çš„è®¾ç½®ï¼›æ•°æ®ä»“åº“åº”ç”¨ï¼ŒåŠ è½½æœ€æ–°çš„è®¾ç½®æ•°æ®åˆ°ä¸­å¤®ä»“åº“ï¼Œç”¨äºä¸åŒç»´æŠ¤çš„æ•°æ®æŸ¥è¯¢å’Œåˆ†æç­‰ç­‰ã€‚</p>
</blockquote>
<p><img src="http://www.confluent.io/wp-content/uploads/2016/09/Event-sourced-based-architecture.jpeg" alt=""><br>åŸºäºäº‹ä»¶é©±åŠ¨çš„æ¶æ„</p>
<p>Event sourcing involves changing the profile web app to model the profile update as an event â€” something important that happened â€” and write it to a central log, like a Kafka topic. In this state of the world, all the applications that need to respond to the profile update event, merely subscribe to the Kafka topic and create the respective materialized views â€“ be it a write to cache, index the event in Elasticsearch or simply compute an in-memory aggregate. The profile web app itself also subscribes to the same Kafka topic and writes the update to the profiles database.</p>
<blockquote>
<p>äº‹ä»¶é©±åŠ¨ä¼šå°†profileåº”ç”¨ç¨‹åºçš„profileæ›´æ–°ä½œä¸ºä¸€ä¸ªäº‹ä»¶ï¼Œå†™å…¥åˆ°ä¸­å¤®æ—¥å¿—ç³»ç»Ÿä¸­ï¼Œæ¯”å¦‚ä¸€ä¸ªKafkaçš„ä¸»é¢˜ã€‚åœ¨è¿™ä¸ªå……æ»¡çŠ¶æ€çš„ä¸–ç•Œä¸­ï¼Œæ‰€æœ‰éœ€è¦å¯¹profileæ›´æ–°äº‹ä»¶ä½œå‡ºå“åº”çš„ï¼Œæ‰€åšçš„å·¥ä½œä»…ä»…æ˜¯è®¢é˜…åˆ°Kafkaçš„ä¸»é¢˜ï¼Œå¹¶åˆ›å»ºå„è‡ªçš„ç‰©åŒ–è§†å›¾ï¼ˆæ¶ˆè´¹è€…è¯»å–æ•°æ®ï¼Œäº§ç”Ÿå„è‡ªçš„æ•°æ®ï¼‰ï¼Œæ¯”å¦‚å°†å…¶ä½œä¸ºç¼“å­˜çš„ä»¥å†™å…¥ã€Elasticsearchçš„ä¸€ä¸ªç´¢å¼•äº‹ä»¶ã€æˆ–è€…åªæ˜¯å†…å­˜ä¸­çš„ç®€å•èšåˆè®¡ç®—ã€‚å½“ç„¶profileåº”ç”¨ç¨‹åºæœ¬èº«ä¹Ÿè¦è®¢é˜…ç›¸åŒçš„Kafkaä¸»é¢˜ï¼ˆå®é™…ä¸Šä¸æ˜¯è®¢é˜…ï¼Œè€Œæ˜¯ç”Ÿäº§ï¼Œè¿™é‡Œçš„æ„æ€æ˜¯ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ä½¿ç”¨ç›¸åŒçš„ä¸»é¢˜ï¼Œå¦åˆ™ç”Ÿäº§è€…ç”Ÿäº§çš„æ¶ˆæ¯æ²¡æœ‰è¢«ä»»ä½•æ¶ˆè´¹è€…è®¢é˜…ï¼Œå°±æ²¡æœ‰ä»€ä¹ˆæ„ä¹‰äº†ã€‚ç”Ÿäº§è€…è¿™é‡Œæ˜¯webåº”ç”¨ç¨‹åºäº§ç”Ÿçš„æ›´æ–°äº‹ä»¶ï¼Œæ¶ˆè´¹è€…æ˜¯ä¸‹æ–¹å„ç§æ•°æ®æºï¼‰ï¼Œå¹¶ä¸”ä¼šå°†æ›´æ–°å†™å…¥åˆ°profilesæ•°æ®åº“ã€‚</p>
</blockquote>
<h2 id="äº‹ä»¶é©±åŠ¨ï¼šä¸€äº›åˆ©å¼Š">äº‹ä»¶é©±åŠ¨ï¼šä¸€äº›åˆ©å¼Š</h2><p>There are several advantages to modeling applications to use event sourcing â€” It provides a complete log of every state change ever made to an object; so troubleshooting is easier. By expressing the user intent as an ordered log of immutable events, event sourcing gives the business an audit and compliance(åˆè§„æ€§å®¡è®¡) log which also has the added benefit of providing data provenance(èµ·æº). It enables resilient(å¼¹æ€§) applications; rolling back applications amounts to rewinding(ç»•å›) the event log and reprocessing data. It has better performance characteristics; writes and reads can be scaled independently. It enables a loosely coupled(æ¾è€¦åˆ) application architecture; one that makes it easier to move towards a microservices-based architecture. But most importantly:</p>
<p><strong>Event sourcing enables building a forward-compatible(å‘å‰å…¼å®¹) application architectureâ€Šâ€”â€Šthe ability to add more applications in the future that need to process the same event but create a different materialized view.</strong></p>
<blockquote>
<p>å°†åº”ç”¨ç¨‹åºå»ºæ¨¡æˆäº‹ä»¶é©±åŠ¨æœ‰å¾ˆå¤šä¼˜ç‚¹ï¼šå®ƒæä¾›äº†é’ˆå¯¹ä¸€ä¸ªå¯¹è±¡çš„æ¯ä¸ªçŠ¶æ€æ”¹å˜çš„å®Œæ•´æ—¥å¿—ï¼Œæ‰€ä»¥æ’æŸ¥é—®é¢˜éå¸¸ç®€å•ã€‚</p>
</blockquote>
<p>For the upsides mentioned above, there are some downsides as well. Event sourcing has a higher learning curve(æ›²çº¿); it is a new and unfamiliar programming model. The event log might involve more work to query it as it requires converting the events into the required materialized state suitable to query.</p>
<p>That was a quick introduction to event sourcing and some tradeoffs. This article is not meant to go into details of event sourcing or advocate for itâ€™s usage. You can read more about event sourcing and various tradeoffs <a href="http://martinfowler.com/eaaDev/EventSourcing.html" target="_blank" rel="external">here</a>.</p>
<p>é™¤äº†ä¸Šé¢æåˆ°çš„ä¸€äº›ä¼˜ç‚¹ï¼Œå½“ç„¶å®ƒä¹Ÿæœ‰ç¼ºç‚¹ã€‚äº‹ä»¶é©±åŠ¨æœ‰æ›´é«˜çš„å­¦ä¹ æ›²çº¿ï¼Œå®ƒæ˜¯ä¸€ç§å´­æ–°çš„ã€ä¸ç†Ÿæ‚‰çš„ç¼–ç¨‹æ¨¡å‹ã€‚</p>
<h2 id="Kafkaä½œä¸ºäº‹ä»¶é©±åŠ¨çš„æ”¯æŸ±">Kafkaä½œä¸ºäº‹ä»¶é©±åŠ¨çš„æ”¯æŸ±</h2><h2 id="äº‹ä»¶é©±åŠ¨å’ŒCQRS">äº‹ä»¶é©±åŠ¨å’ŒCQRS</h2><h2 id="CQRSå’ŒKafka_Streams">CQRSå’ŒKafka Streams</h2><h3 id="æ–¹æ¡ˆ1ï¼šåº”ç”¨ç¨‹åºçŠ¶æ€å­˜å‚¨åˆ°å¤–éƒ¨å­˜å‚¨">æ–¹æ¡ˆ1ï¼šåº”ç”¨ç¨‹åºçŠ¶æ€å­˜å‚¨åˆ°å¤–éƒ¨å­˜å‚¨</h3><h3 id="æ–¹æ¡ˆ2ï¼šåº”ç”¨ç¨‹åºçŠ¶æ€å­˜å‚¨åˆ°Kafka_Streamsçš„æœ¬åœ°çŠ¶æ€">æ–¹æ¡ˆ2ï¼šåº”ç”¨ç¨‹åºçŠ¶æ€å­˜å‚¨åˆ°Kafka Streamsçš„æœ¬åœ°çŠ¶æ€</h3><h2 id="Kafka_Streamsçš„äº¤äº’å¼æŸ¥è¯¢">Kafka Streamsçš„äº¤äº’å¼æŸ¥è¯¢</h2><h2 id="äº¤äº’å¼æŸ¥è¯¢çš„ç”¨ä¾‹">äº¤äº’å¼æŸ¥è¯¢çš„ç”¨ä¾‹</h2><h2 id="ä½¿ç”¨Kafkaä½œä¸ºäº‹ä»¶é©±åŠ¨ã€CQRS">ä½¿ç”¨Kafkaä½œä¸ºäº‹ä»¶é©±åŠ¨ã€CQRS</h2><h3 id="é›¶å”®åº—ç¤ºä¾‹">é›¶å”®åº—ç¤ºä¾‹</h3>
      
    </div>
    
  </div>
  
    
<div class="copyright">
  <p><span>æœ¬æ–‡æ ‡é¢˜:</span><a href="/2016/11/18/Kafka-CQRS-Streams/">è¯‘ï¼šKafkaäº‹ä»¶é©±åŠ¨å’Œæµå¤„ç†</a></p>
  <p><span>æ–‡ç« ä½œè€…:</span><a href="/" title="è®¿é—® ä»»ä½•å¿§ä¼¤,éƒ½æŠµä¸è¿‡ä¸–ç•Œçš„ç¾ä¸½ çš„ä¸ªäººåšå®¢">ä»»ä½•å¿§ä¼¤,éƒ½æŠµä¸è¿‡ä¸–ç•Œçš„ç¾ä¸½</a></p>
  <p><span>å‘å¸ƒæ—¶é—´:</span>2016å¹´11æœˆ18æ—¥ - 00æ—¶00åˆ†</p>
  <p><span>æœ€åæ›´æ–°:</span>2016å¹´10æœˆ29æ—¥ - 11æ—¶50åˆ†</p>
  <p>
    <span>åŸå§‹é“¾æ¥:</span><a href="/2016/11/18/Kafka-CQRS-Streams/" title="è¯‘ï¼šKafkaäº‹ä»¶é©±åŠ¨å’Œæµå¤„ç†">http://github.com/zqhxuyuan/2016/11/18/Kafka-CQRS-Streams/</a>
    <span class="btn" data-clipboard-text="åŸæ–‡: http://github.com/zqhxuyuan/2016/11/18/Kafka-CQRS-Streams/ã€€ã€€ä½œè€…: ä»»ä½•å¿§ä¼¤,éƒ½æŠµä¸è¿‡ä¸–ç•Œçš„ç¾ä¸½" title="ç‚¹å‡»å¤åˆ¶æ–‡ç« é“¾æ¥">
        <i class="fa fa-clipboard"></i>
    </span>
  </p>
  <p><span>è®¸å¯åè®®:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" title="ä¸­å›½å¤§é™† (CC BY-NC-SA 3.0 CN)">"ç½²å-éå•†ç”¨-ç›¸åŒæ–¹å¼å…±äº« 3.0"</a> è½¬è½½è¯·ä¿ç•™åŸæ–‡é“¾æ¥åŠä½œè€…ã€‚</p>
  <script src="/js/clipboard.min.js"></script>
  <script> var clipboard = new Clipboard('.btn'); </script>
</div>
<style type="text/css">
  .copyright p .btn {
    margin-left: 1em;
  }
  .copyright:hover p .btn::after {
    content: "å¤åˆ¶"
  }
  .copyright p .btn:hover {
      color: gray;
      cursor: pointer;
    };
</style>



<nav id="article-nav">
  
    <div id="article-nav-newer" class="article-nav-title">
      <a href="/2016/12/31/Tools-BigData-Monitor/">
        ç›‘æ§å·¥å…·é›†é”¦
      </a>
    </div>
  
  
    <div id="article-nav-older" class="article-nav-title">
      <a href="/2016/11/11/Data-Transform/">
        ETL Tools
      </a>
    </div>
  
</nav>

  
  
    <div class ="post-donate">
	<br/>
	<p>
    <div id="donate_board" class="donate_bar center">
        <a id="btn_donate" class="btn_donate" href="javascript:;" title="æ‰“èµ"></a>
        <span class="donate_txt">
           &uarr;<br>
		   è¿™ä¹ˆé•¿çš„æ–‡ç« æˆ‘éƒ½è¯»å®Œäº†ï¼Œçœ‹èµ·æ¥ä½œè€…å†™çš„å¾ˆè¾›è‹¦å“‡ï¼ç»™ä½œè€…èµæ¯å’–å•¡å–ï¼Œæ”¯æŒä½œè€…ç»§ç»­å†™ä½œğŸ˜
        </span>
        <br>
    </div>  
	<div id="donate_guide" class="donate_bar center hidden" >
		<img src="/img/zhifubao.png" alt="æ”¯ä»˜å®æ‰“èµ"> 
		<img src="/img/weixin.png" alt="å¾®ä¿¡æ‰“èµ">  
    </div>
	<script type="text/javascript">
		document.getElementById('btn_donate').onclick = function(){
			$('#donate_board').addClass('hidden');
			$('#donate_guide').removeClass('hidden');
		}
	</script>
</div>
  
</article>

<!-- é»˜è®¤æ˜¾ç¤ºæ–‡ç« ç›®å½•ï¼Œåœ¨æ–‡ç« ---å‰è¾“å…¥toc: falseå…³é—­ç›®å½• -->
<!-- Show TOC and tocButton in default, Hide TOC via putting "toc: false" before "---" at [post].md -->
<div id="toc" class="toc-article">
<strong class="toc-title">æ–‡ç« ç›®å½•</strong>
<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#äº‹ä»¶é©±åŠ¨ï¼šä¸€äº›åˆ©å¼Š"><span class="toc-number">1.</span> <span class="toc-text">äº‹ä»¶é©±åŠ¨ï¼šä¸€äº›åˆ©å¼Š</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Kafkaä½œä¸ºäº‹ä»¶é©±åŠ¨çš„æ”¯æŸ±"><span class="toc-number">2.</span> <span class="toc-text">Kafkaä½œä¸ºäº‹ä»¶é©±åŠ¨çš„æ”¯æŸ±</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#äº‹ä»¶é©±åŠ¨å’ŒCQRS"><span class="toc-number">3.</span> <span class="toc-text">äº‹ä»¶é©±åŠ¨å’ŒCQRS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CQRSå’ŒKafka_Streams"><span class="toc-number">4.</span> <span class="toc-text">CQRSå’ŒKafka Streams</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#æ–¹æ¡ˆ1ï¼šåº”ç”¨ç¨‹åºçŠ¶æ€å­˜å‚¨åˆ°å¤–éƒ¨å­˜å‚¨"><span class="toc-number">4.1.</span> <span class="toc-text">æ–¹æ¡ˆ1ï¼šåº”ç”¨ç¨‹åºçŠ¶æ€å­˜å‚¨åˆ°å¤–éƒ¨å­˜å‚¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#æ–¹æ¡ˆ2ï¼šåº”ç”¨ç¨‹åºçŠ¶æ€å­˜å‚¨åˆ°Kafka_Streamsçš„æœ¬åœ°çŠ¶æ€"><span class="toc-number">4.2.</span> <span class="toc-text">æ–¹æ¡ˆ2ï¼šåº”ç”¨ç¨‹åºçŠ¶æ€å­˜å‚¨åˆ°Kafka Streamsçš„æœ¬åœ°çŠ¶æ€</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Kafka_Streamsçš„äº¤äº’å¼æŸ¥è¯¢"><span class="toc-number">5.</span> <span class="toc-text">Kafka Streamsçš„äº¤äº’å¼æŸ¥è¯¢</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#äº¤äº’å¼æŸ¥è¯¢çš„ç”¨ä¾‹"><span class="toc-number">6.</span> <span class="toc-text">äº¤äº’å¼æŸ¥è¯¢çš„ç”¨ä¾‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ä½¿ç”¨Kafkaä½œä¸ºäº‹ä»¶é©±åŠ¨ã€CQRS"><span class="toc-number">7.</span> <span class="toc-text">ä½¿ç”¨Kafkaä½œä¸ºäº‹ä»¶é©±åŠ¨ã€CQRS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#é›¶å”®åº—ç¤ºä¾‹"><span class="toc-number">7.1.</span> <span class="toc-text">é›¶å”®åº—ç¤ºä¾‹</span></a></li></ol></li></ol>
</div>
<style type="text/css">
  .left-col .switch-btn {
    display: none;
  }
  .left-col .switch-area {
    display: none;
  }
</style>

<input type="button" id="tocButton" value="éšè—ç›®å½•"  title="ç‚¹å‡»æŒ‰é’®éšè—æˆ–è€…æ˜¾ç¤ºæ–‡ç« ç›®å½•">
<script type="text/javascript">
  var toc_button= document.getElementById("tocButton");
  var toc_div= document.getElementById("toc");
  /* Show or hide toc when click on tocButton.
  é€šè¿‡ç‚¹å‡»è®¾ç½®çš„æŒ‰é’®æ˜¾ç¤ºæˆ–è€…éšè—æ–‡ç« ç›®å½•.*/
  toc_button.onclick=function(){
  if(toc_div.style.display=="none"){
  toc_div.style.display="block";
  toc_button.value="éšè—ç›®å½•";
  document.getElementById("switch-btn").style.display="none";
  document.getElementById("switch-area").style.display="none";
  }
  else{
  toc_div.style.display="none";
  toc_button.value="æ˜¾ç¤ºç›®å½•";
  document.getElementById("switch-btn").style.display="block";
  document.getElementById("switch-area").style.display="block";
  }
  }
    if ($(".toc").length < 1) {
        $("#toc").css("display","none");
        $("#tocButton").css("display","none");
        $(".switch-btn").css("display","block");
        $(".switch-area").css("display","block");
    }
</script>


    <style>
        .toc {
            white-space: nowrap;
            overflow-x: hidden;
        }
    </style>

    <script>
        $(document).ready(function() {
            $(".toc li a").mouseover(function() {
                var title = $(this).attr('href');
                $(this).attr("title", title);
            });
        })
    </script>




<div class="share">
	<div class="bdsharebuttonbox">
	<a href="#" class="bds_more" data-cmd="more"></a>
	<a href="#" class="bds_tsina" data-cmd="tsina" title="åˆ†äº«åˆ°æ–°æµªå¾®åš"></a>
	<a href="#" class="bds_sqq" data-cmd="sqq" title="åˆ†äº«ç»™ QQ å¥½å‹"></a>
	<a href="#" class="bds_copy" data-cmd="copy" title="å¤åˆ¶ç½‘å€"></a>
	<a href="#" class="bds_mail" data-cmd="mail" title="é€šè¿‡é‚®ä»¶åˆ†äº«"></a>
	<a href="#" class="bds_weixin" data-cmd="weixin" title="ç”Ÿæˆæ–‡ç« äºŒç»´ç "></a>
	</div>
	<script>
	window._bd_share_config={
		"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
	</script>
</div>



<div class="duoshuo" id="comments">
	<!-- å¤šè¯´è¯„è®ºæ¡† start -->
	<div class="ds-thread" data-thread-key="2016/11/18/Kafka-CQRS-Streams/" data-title="è¯‘ï¼šKafkaäº‹ä»¶é©±åŠ¨å’Œæµå¤„ç†" data-url="http://github.com/zqhxuyuan/2016/11/18/Kafka-CQRS-Streams/"></div>
	<!-- å¤šè¯´è¯„è®ºæ¡† end -->
	<!-- å¤šè¯´å…¬å…±JSä»£ç  start (ä¸€ä¸ªç½‘é¡µåªéœ€æ’å…¥ä¸€æ¬¡) -->
	<script type="text/javascript">
	var duoshuoQuery = {short_name:"zqhxuyuan"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
	<!-- å¤šè¯´å…¬å…±JSä»£ç  end -->
</div>






    <style type="text/css">
    #scroll {
      display: none;
    }
    </style>
    <div class="scroll">
    <a href="#" title="è¿”å›é¡¶éƒ¨"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" title="æŸ¥çœ‹è¯„è®º"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="è½¬åˆ°åº•éƒ¨"><i class="fa fa-arrow-down"></i></a>
    </div>


  
  
    
    <div  class="post-nav-button">
    <a href="/2016/12/31/Tools-BigData-Monitor/" title="ä¸Šä¸€ç¯‡: ç›‘æ§å·¥å…·é›†é”¦">
    <i class="fa fa-angle-left"></i>
    </a>
    <a href="/2016/11/11/Data-Transform/" title="ä¸‹ä¸€ç¯‡: ETL Tools">
    <i class="fa fa-angle-right"></i>
    </a>
    </div>
  



    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
        <script>
        var yiliaConfig = {
        fancybox: true,
        mathjax: true,
        animate: true,
        isHome: false,
        isPost: true,
        isArchive: false,
        isTag: false,
        isCategory: false,
        open_in_new: false
        }
        </script>
        
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2017 ä»»ä½•å¿§ä¼¤,éƒ½æŠµä¸è¿‡ä¸–ç•Œçš„ç¾ä¸½
      </div>
        <div class="footer-right">
          <a href="http://hexo.io/" target="_blank" title="å¿«é€Ÿã€ç®€æ´ä¸”é«˜æ•ˆçš„é™æ€åšå®¢æ¡†æ¶">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="ç®€è€Œä¸å‡åŒæ  Hexo åšå®¢ä¸»é¢˜">Yelee</a> by MOxFIVE
        </div>
    </div>
    <div class="visit">
      <span id="busuanzi_container_site_pv" style='display:none'>
        <span id="site-visit" >æœ¬ç«™åˆ°è®¿æ•°: 
        <span id="busuanzi_value_site_uv"></span>
        </span>
      </span>
      <span id="busuanzi_container_page_pv" style='display:none'>
        <span id="page-visit">, æœ¬é¡µé˜…è¯»é‡: 
        <span id="busuanzi_value_page_pv"></span>
        </span>
      </span>
    </div>
  </div>
</footer>
    </div>
    

<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>

<script>
  var backgroundnum = 5;
  var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));

  $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
</script>


<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-80646710-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<div class="scroll" id="scroll">
<a href="#" title="è¿”å›é¡¶éƒ¨"><i class="fa fa-arrow-up"></i></a>
<a href="#footer" title="è½¬åˆ°åº•éƒ¨"><i class="fa fa-arrow-down"></i></a>
</div>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>